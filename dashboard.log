1

2025-10-22 15:23:09,838 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:23:09,838 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:23:09,850 - __main__ - INFO - get_todays_alerts:138 - 📊 Getting today's alerts
2025-10-22 15:23:09,851 - root - INFO - <module>:603 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:23:09,851 - __main__ - INFO - get_alerts_by_time_range:127 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:23:09.850740
2025-10-22 15:23:09,852 - __main__ - DEBUG - _make_request:73 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:23:09,853 - __main__ - DEBUG - _make_request:74 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:23:09.850740",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:23:09,857 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:23:09,895 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:9000
 * Running on http://10.10.192.191:9000
2025-10-22 15:23:09,895 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-10-22 15:23:09,897 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-10-22 15:23:09,910 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 118472
2025-10-22 15:23:09,912 - __main__ - DEBUG - _make_request:77 - 🔍 Response status: 200
2025-10-22 15:23:09,918 - __main__ - DEBUG - _make_request:82 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:23:09,918 - __main__ - DEBUG - _make_request:86 - 🔍 Total hits: 73, Actual hits: 73
2025-10-22 15:23:09,919 - __main__ - DEBUG - _make_request:91 - 🔍 First hit ID: RHoBC5oBnysS8cfeYnKq
2025-10-22 15:23:09,919 - __main__ - DEBUG - _make_request:92 - 🔍 First hit timestamp: 2025-10-22T08:20:28.449Z
2025-10-22 15:23:09,919 - __main__ - DEBUG - _make_request:93 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:23:09,919 - root - DEBUG - process_alerts_for_dashboard:231 - 🔄 Processing alerts for dashboard
2025-10-22 15:23:09,920 - root - INFO - process_alerts_for_dashboard:245 - 🔄 Processing 73 total alerts, 73 returned
2025-10-22 15:23:09,921 - root - INFO - process_alerts_for_dashboard:301 - ✅ Processed 73 alerts for dashboard
2025-10-22 15:23:11,278 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:23:11,278 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:23:11,290 - __main__ - INFO - get_todays_alerts:138 - 📊 Getting today's alerts
2025-10-22 15:23:11,291 - root - INFO - <module>:603 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:23:11,291 - __main__ - INFO - get_alerts_by_time_range:127 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:23:11.290817
2025-10-22 15:23:11,292 - __main__ - DEBUG - _make_request:73 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:23:11,292 - __main__ - DEBUG - _make_request:74 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:23:11.290817",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:23:11,296 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:23:11,327 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-10-22 15:23:11,331 - werkzeug - INFO - _log:97 -  * Debugger PIN: 407-185-390
2025-10-22 15:23:11,343 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 118472
2025-10-22 15:23:11,346 - __main__ - DEBUG - _make_request:77 - 🔍 Response status: 200
2025-10-22 15:23:11,350 - __main__ - DEBUG - _make_request:82 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:23:11,351 - __main__ - DEBUG - _make_request:86 - 🔍 Total hits: 73, Actual hits: 73
2025-10-22 15:23:11,351 - __main__ - DEBUG - _make_request:91 - 🔍 First hit ID: RHoBC5oBnysS8cfeYnKq
2025-10-22 15:23:11,351 - __main__ - DEBUG - _make_request:92 - 🔍 First hit timestamp: 2025-10-22T08:20:28.449Z
2025-10-22 15:23:11,351 - __main__ - DEBUG - _make_request:93 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:23:11,351 - root - DEBUG - process_alerts_for_dashboard:231 - 🔄 Processing alerts for dashboard
2025-10-22 15:23:11,352 - root - INFO - process_alerts_for_dashboard:245 - 🔄 Processing 73 total alerts, 73 returned
2025-10-22 15:23:11,353 - root - INFO - process_alerts_for_dashboard:301 - ✅ Processed 73 alerts for dashboard
2025-10-22 15:23:39,922 - __main__ - INFO - get_todays_alerts:138 - 📊 Getting today's alerts
2025-10-22 15:23:39,922 - __main__ - INFO - get_alerts_by_time_range:127 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:23:39.922017
2025-10-22 15:23:39,922 - __main__ - DEBUG - _make_request:73 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:23:39,923 - __main__ - DEBUG - _make_request:74 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:23:39.922017",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:23:39,956 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 118472
2025-10-22 15:23:39,958 - __main__ - DEBUG - _make_request:77 - 🔍 Response status: 200
2025-10-22 15:23:39,962 - __main__ - DEBUG - _make_request:82 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:23:39,963 - __main__ - DEBUG - _make_request:86 - 🔍 Total hits: 73, Actual hits: 73
2025-10-22 15:23:39,963 - __main__ - DEBUG - _make_request:91 - 🔍 First hit ID: RHoBC5oBnysS8cfeYnKq
2025-10-22 15:23:39,963 - __main__ - DEBUG - _make_request:92 - 🔍 First hit timestamp: 2025-10-22T08:20:28.449Z
2025-10-22 15:23:39,963 - __main__ - DEBUG - _make_request:93 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:23:39,964 - root - DEBUG - process_alerts_for_dashboard:231 - 🔄 Processing alerts for dashboard
2025-10-22 15:23:39,964 - root - INFO - process_alerts_for_dashboard:245 - 🔄 Processing 73 total alerts, 73 returned
2025-10-22 15:23:39,965 - root - INFO - process_alerts_for_dashboard:301 - ✅ Processed 73 alerts for dashboard
2025-10-22 15:23:41,354 - __main__ - INFO - get_todays_alerts:138 - 📊 Getting today's alerts
2025-10-22 15:23:41,354 - __main__ - INFO - get_alerts_by_time_range:127 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:23:41.354484
2025-10-22 15:23:41,355 - __main__ - DEBUG - _make_request:73 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:23:41,355 - __main__ - DEBUG - _make_request:74 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:23:41.354484",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:23:41,382 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 118472
2025-10-22 15:23:41,384 - __main__ - DEBUG - _make_request:77 - 🔍 Response status: 200
2025-10-22 15:23:41,388 - __main__ - DEBUG - _make_request:82 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:23:41,388 - __main__ - DEBUG - _make_request:86 - 🔍 Total hits: 73, Actual hits: 73
2025-10-22 15:23:41,389 - __main__ - DEBUG - _make_request:91 - 🔍 First hit ID: RHoBC5oBnysS8cfeYnKq
2025-10-22 15:23:41,389 - __main__ - DEBUG - _make_request:92 - 🔍 First hit timestamp: 2025-10-22T08:20:28.449Z
2025-10-22 15:23:41,389 - __main__ - DEBUG - _make_request:93 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:23:41,389 - root - DEBUG - process_alerts_for_dashboard:231 - 🔄 Processing alerts for dashboard
2025-10-22 15:23:41,389 - root - INFO - process_alerts_for_dashboard:245 - 🔄 Processing 73 total alerts, 73 returned
2025-10-22 15:23:41,391 - root - INFO - process_alerts_for_dashboard:301 - ✅ Processed 73 alerts for dashboard
2025-10-22 15:24:09,966 - __main__ - INFO - get_todays_alerts:138 - 📊 Getting today's alerts
2025-10-22 15:24:09,966 - __main__ - INFO - get_alerts_by_time_range:127 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:24:09.966563
2025-10-22 15:24:09,967 - __main__ - DEBUG - _make_request:73 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:24:09,967 - __main__ - DEBUG - _make_request:74 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:24:09.966563",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:24:09,991 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:24:09,993 - __main__ - DEBUG - _make_request:77 - 🔍 Response status: 200
2025-10-22 15:24:09,997 - __main__ - DEBUG - _make_request:82 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:24:09,998 - __main__ - DEBUG - _make_request:86 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:24:09,998 - __main__ - DEBUG - _make_request:91 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:24:09,998 - __main__ - DEBUG - _make_request:92 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:24:09,998 - __main__ - DEBUG - _make_request:93 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:24:09,999 - root - DEBUG - process_alerts_for_dashboard:231 - 🔄 Processing alerts for dashboard
2025-10-22 15:24:09,999 - root - INFO - process_alerts_for_dashboard:245 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:24:10,000 - root - INFO - process_alerts_for_dashboard:301 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:24:11,392 - __main__ - INFO - get_todays_alerts:138 - 📊 Getting today's alerts
2025-10-22 15:24:11,392 - __main__ - INFO - get_alerts_by_time_range:127 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:24:11.392035
2025-10-22 15:24:11,392 - __main__ - DEBUG - _make_request:73 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:24:11,393 - __main__ - DEBUG - _make_request:74 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:24:11.392035",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:24:11,423 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:24:11,426 - __main__ - DEBUG - _make_request:77 - 🔍 Response status: 200
2025-10-22 15:24:11,430 - __main__ - DEBUG - _make_request:82 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:24:11,430 - __main__ - DEBUG - _make_request:86 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:24:11,431 - __main__ - DEBUG - _make_request:91 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:24:11,431 - __main__ - DEBUG - _make_request:92 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:24:11,431 - __main__ - DEBUG - _make_request:93 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:24:11,431 - root - DEBUG - process_alerts_for_dashboard:231 - 🔄 Processing alerts for dashboard
2025-10-22 15:24:11,432 - root - INFO - process_alerts_for_dashboard:245 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:24:11,433 - root - INFO - process_alerts_for_dashboard:301 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:24:40,001 - __main__ - INFO - get_todays_alerts:138 - 📊 Getting today's alerts
2025-10-22 15:24:40,002 - __main__ - INFO - get_alerts_by_time_range:127 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:24:40.001242
2025-10-22 15:24:40,002 - __main__ - DEBUG - _make_request:73 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:24:40,003 - __main__ - DEBUG - _make_request:74 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:24:40.001242",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:24:40,029 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:24:40,030 - __main__ - DEBUG - _make_request:77 - 🔍 Response status: 200
2025-10-22 15:24:40,034 - __main__ - DEBUG - _make_request:82 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:24:40,035 - __main__ - DEBUG - _make_request:86 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:24:40,035 - __main__ - DEBUG - _make_request:91 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:24:40,035 - __main__ - DEBUG - _make_request:92 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:24:40,035 - __main__ - DEBUG - _make_request:93 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:24:40,036 - root - DEBUG - process_alerts_for_dashboard:231 - 🔄 Processing alerts for dashboard
2025-10-22 15:24:40,036 - root - INFO - process_alerts_for_dashboard:245 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:24:40,037 - root - INFO - process_alerts_for_dashboard:301 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:24:41,434 - __main__ - INFO - get_todays_alerts:138 - 📊 Getting today's alerts
2025-10-22 15:24:41,434 - __main__ - INFO - get_alerts_by_time_range:127 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:24:41.434174
2025-10-22 15:24:41,434 - __main__ - DEBUG - _make_request:73 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:24:41,435 - __main__ - DEBUG - _make_request:74 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:24:41.434174",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:24:41,462 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:24:41,464 - __main__ - DEBUG - _make_request:77 - 🔍 Response status: 200
2025-10-22 15:24:41,468 - __main__ - DEBUG - _make_request:82 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:24:41,468 - __main__ - DEBUG - _make_request:86 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:24:41,468 - __main__ - DEBUG - _make_request:91 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:24:41,469 - __main__ - DEBUG - _make_request:92 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:24:41,469 - __main__ - DEBUG - _make_request:93 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:24:41,469 - root - DEBUG - process_alerts_for_dashboard:231 - 🔄 Processing alerts for dashboard
2025-10-22 15:24:41,469 - root - INFO - process_alerts_for_dashboard:245 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:24:41,471 - root - INFO - process_alerts_for_dashboard:301 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:34:11,963 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:34:11,964 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:34:11,977 - __main__ - INFO - get_todays_alerts:160 - 📊 Getting today's alerts
2025-10-22 15:34:11,977 - root - INFO - <module>:625 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:34:11,978 - __main__ - INFO - get_alerts_by_time_range:149 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:34:11.977501
2025-10-22 15:34:11,979 - __main__ - DEBUG - _make_request:95 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:34:11,980 - __main__ - DEBUG - _make_request:96 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:34:11.977501",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:34:11,983 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:34:12,026 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:9000
 * Running on http://10.10.192.191:9000
2025-10-22 15:34:12,026 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-10-22 15:34:12,028 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-10-22 15:34:12,034 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:34:12,037 - __main__ - DEBUG - _make_request:99 - 🔍 Response status: 200
2025-10-22 15:34:12,042 - __main__ - DEBUG - _make_request:104 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:34:12,042 - __main__ - DEBUG - _make_request:108 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:34:12,042 - __main__ - DEBUG - _make_request:113 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:34:12,042 - __main__ - DEBUG - _make_request:114 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:34:12,043 - __main__ - DEBUG - _make_request:115 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:34:12,043 - root - DEBUG - process_alerts_for_dashboard:253 - 🔄 Processing alerts for dashboard
2025-10-22 15:34:12,043 - root - INFO - process_alerts_for_dashboard:267 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:34:12,045 - root - INFO - process_alerts_for_dashboard:323 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:34:13,433 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:34:13,434 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:34:13,447 - __main__ - INFO - get_todays_alerts:160 - 📊 Getting today's alerts
2025-10-22 15:34:13,447 - root - INFO - <module>:625 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:34:13,447 - __main__ - INFO - get_alerts_by_time_range:149 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:34:13.446973
2025-10-22 15:34:13,448 - __main__ - DEBUG - _make_request:95 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:34:13,449 - __main__ - DEBUG - _make_request:96 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:34:13.446973",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:34:13,459 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:34:13,486 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-10-22 15:34:13,490 - werkzeug - INFO - _log:97 -  * Debugger PIN: 277-575-298
2025-10-22 15:34:13,509 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:34:13,511 - __main__ - DEBUG - _make_request:99 - 🔍 Response status: 200
2025-10-22 15:34:13,516 - __main__ - DEBUG - _make_request:104 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:34:13,516 - __main__ - DEBUG - _make_request:108 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:34:13,517 - __main__ - DEBUG - _make_request:113 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:34:13,517 - __main__ - DEBUG - _make_request:114 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:34:13,517 - __main__ - DEBUG - _make_request:115 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:34:13,518 - root - DEBUG - process_alerts_for_dashboard:253 - 🔄 Processing alerts for dashboard
2025-10-22 15:34:13,518 - root - INFO - process_alerts_for_dashboard:267 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:34:13,519 - root - INFO - process_alerts_for_dashboard:323 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:34:55,513 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:34:55,513 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:34:55,526 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:34:55,526 - root - INFO - <module>:621 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:34:55,526 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:34:55.526435
2025-10-22 15:34:55,527 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:34:55,528 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:34:55.526435",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:34:55,530 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:34:55,570 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:9000
 * Running on http://10.10.192.191:9000
2025-10-22 15:34:55,570 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-10-22 15:34:55,572 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-10-22 15:34:55,593 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:34:55,596 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:34:55,600 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:34:55,600 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:34:55,601 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:34:55,601 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:34:55,601 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:34:55,601 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:34:55,601 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:34:55,602 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:34:57,044 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:34:57,044 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:34:57,055 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:34:57,056 - root - INFO - <module>:621 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:34:57,056 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:34:57.055825
2025-10-22 15:34:57,056 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:34:57,057 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:34:57.055825",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:34:57,059 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:34:57,094 - werkzeug - WARNING - _log:97 -  * Debugger is active!
2025-10-22 15:34:57,095 - werkzeug - INFO - _log:97 -  * Debugger PIN: 277-575-298
2025-10-22 15:34:57,107 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:34:57,110 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:34:57,114 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:34:57,114 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:34:57,115 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:34:57,115 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:34:57,115 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:34:57,115 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:34:57,115 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:34:57,116 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:35:06,668 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:06] "[36mGET /search-analytics HTTP/1.1[0m" 304 -
2025-10-22 15:35:06,718 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:06] "[36mGET /static/css/dashboard.css HTTP/1.1[0m" 304 -
2025-10-22 15:35:06,719 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:06] "[36mGET /static/css/responsive.css HTTP/1.1[0m" 304 -
2025-10-22 15:35:06,721 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:06] "[36mGET /static/css/main.css HTTP/1.1[0m" 304 -
2025-10-22 15:35:06,722 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:06] "[36mGET /static/js/search-analytics.js HTTP/1.1[0m" 304 -
2025-10-22 15:35:06,811 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:06] "GET /api/search/saved HTTP/1.1" 200 -
2025-10-22 15:35:06,814 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:35:06,817 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:06] "GET /api/search/fields HTTP/1.1" 200 -
2025-10-22 15:35:07,668 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /_cluster/health HTTP/1.1" 401 12
2025-10-22 15:35:07,669 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:07] "[35m[1mGET /api/search/test-connection HTTP/1.1[0m" 500 -
2025-10-22 15:35:08,360 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:08] "[36mGET / HTTP/1.1[0m" 304 -
2025-10-22 15:35:08,408 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:08] "[36mGET /static/css/main.css HTTP/1.1[0m" 304 -
2025-10-22 15:35:08,414 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:08] "[36mGET /static/css/dashboard.css HTTP/1.1[0m" 304 -
2025-10-22 15:35:08,417 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:08] "[36mGET /static/css/responsive.css HTTP/1.1[0m" 304 -
2025-10-22 15:35:08,421 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:08] "[36mGET /static/js/charts.js HTTP/1.1[0m" 304 -
2025-10-22 15:35:08,424 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:08] "[36mGET /static/js/utils.js HTTP/1.1[0m" 304 -
2025-10-22 15:35:08,428 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:08] "[36mGET /static/js/filters.js HTTP/1.1[0m" 304 -
2025-10-22 15:35:08,434 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:08] "[36mGET /static/js/app.js HTTP/1.1[0m" 304 -
2025-10-22 15:35:08,436 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:08] "[36mGET /static/js/realtime.js HTTP/1.1[0m" 304 -
2025-10-22 15:35:08,496 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:35:08,496 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:35:08.496653
2025-10-22 15:35:08,497 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:35:08,497 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:35:08.496653",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:35:08,523 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:35:08,524 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:35:08,529 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:35:08,529 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:35:08,529 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:35:08,529 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:35:08,529 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:35:08,529 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:35:08,530 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:35:08,531 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:35:08,555 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:08] "GET /api/dashboard-data HTTP/1.1" 200 -
2025-10-22 15:35:25,603 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:35:25,603 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:35:25.603271
2025-10-22 15:35:25,603 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:35:25,604 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:35:25.603271",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:35:25,642 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:35:25,645 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:35:25,653 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:35:25,653 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:35:25,653 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:35:25,653 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:35:25,654 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:35:25,654 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:35:25,654 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:35:25,656 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:35:27,117 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:35:27,117 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:35:27.117572
2025-10-22 15:35:27,117 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:35:27,118 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:35:27.117572",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:35:27,147 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:35:27,148 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:35:27,153 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:35:27,153 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:35:27,154 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:35:27,154 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:35:27,154 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:35:27,154 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:35:27,154 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:35:27,155 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:35:38,500 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:35:38,500 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:35:38.500364
2025-10-22 15:35:38,500 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:35:38,501 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:35:38.500364",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:35:38,529 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:35:38,530 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:35:38,533 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:35:38,533 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:35:38,533 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:35:38,534 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:35:38,534 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:35:38,534 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:35:38,534 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:35:38,535 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:35:38,559 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:35:38] "GET /api/dashboard-data HTTP/1.1" 200 -
2025-10-22 15:35:55,657 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:35:55,657 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:35:55.657578
2025-10-22 15:35:55,658 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:35:55,658 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:35:55.657578",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:35:55,686 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:35:55,688 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:35:55,692 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:35:55,692 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:35:55,692 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:35:55,692 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:35:55,692 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:35:55,692 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:35:55,693 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:35:55,694 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:35:57,155 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:35:57,156 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:35:57.155936
2025-10-22 15:35:57,156 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:35:57,156 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:35:57.155936",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:35:57,184 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:35:57,186 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:35:57,189 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:35:57,189 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:35:57,189 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:35:57,189 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:35:57,189 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:35:57,190 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:35:57,190 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:35:57,191 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:36:08,500 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:36:08,501 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:36:08.500910
2025-10-22 15:36:08,501 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:36:08,501 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:36:08.500910",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:36:08,532 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:36:08,534 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:36:08,537 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:36:08,538 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:36:08,538 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:36:08,538 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:36:08,538 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:36:08,538 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:36:08,538 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:36:08,539 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:36:08,563 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:36:08] "GET /api/dashboard-data HTTP/1.1" 200 -
2025-10-22 15:36:25,694 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:36:25,695 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:36:25.694846
2025-10-22 15:36:25,695 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:36:25,695 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:36:25.694846",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:36:25,721 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:36:25,723 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:36:25,727 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:36:25,727 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:36:25,728 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:36:25,728 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:36:25,728 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:36:25,728 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:36:25,728 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:36:25,729 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:36:27,191 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:36:27,192 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:36:27.191780
2025-10-22 15:36:27,192 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:36:27,192 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:36:27.191780",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:36:27,218 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:36:27,220 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:36:27,223 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:36:27,223 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:36:27,223 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:36:27,223 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:36:27,223 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:36:27,223 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:36:27,224 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:36:27,225 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:36:55,730 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:36:55,730 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:36:55.730289
2025-10-22 15:36:55,730 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:36:55,731 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:36:55.730289",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:36:55,756 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:36:55,758 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:36:55,762 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:36:55,762 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:36:55,762 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:36:55,762 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:36:55,763 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:36:55,763 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:36:55,763 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:36:55,764 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:36:57,225 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:36:57,225 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:36:57.225646
2025-10-22 15:36:57,226 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:36:57,226 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:36:57.225646",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:36:57,255 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:36:57,257 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:36:57,260 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:36:57,260 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:36:57,260 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:36:57,260 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:36:57,261 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:36:57,261 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:36:57,261 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:36:57,263 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:37:25,765 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:37:25,765 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:37:25.765024
2025-10-22 15:37:25,765 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:37:25,765 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:37:25.765024",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:37:25,800 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:37:25,802 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:37:25,809 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:37:25,809 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:37:25,809 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:37:25,809 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:37:25,809 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:37:25,810 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:37:25,810 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:37:25,811 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:37:27,264 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:37:27,264 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:37:27.264169
2025-10-22 15:37:27,265 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:37:27,265 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:37:27.264169",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:37:27,294 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:37:27,296 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:37:27,301 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:37:27,301 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:37:27,301 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:37:27,301 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:37:27,301 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:37:27,302 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:37:27,302 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:37:27,303 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:37:55,812 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:37:55,812 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:37:55.811957
2025-10-22 15:37:55,812 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:37:55,812 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:37:55.811957",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:37:55,841 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:37:55,843 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:37:55,847 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:37:55,847 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:37:55,847 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:37:55,847 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:37:55,847 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:37:55,848 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:37:55,848 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:37:55,849 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:37:57,304 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:37:57,304 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:37:57.304256
2025-10-22 15:37:57,304 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:37:57,305 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:37:57.304256",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:37:57,337 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:37:57,339 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:37:57,343 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:37:57,343 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:37:57,343 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:37:57,343 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:37:57,343 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:37:57,344 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:37:57,344 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:37:57,345 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:38:08,139 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:38:08,140 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:38:08.139755
2025-10-22 15:38:08,140 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:38:08,140 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:38:08.139755",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:38:08,165 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:38:08,168 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:38:08,174 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:38:08,175 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:38:08,175 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:38:08,175 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:38:08,175 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:38:08,175 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:38:08,176 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:38:08,178 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:38:08,223 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:38:08] "GET /api/dashboard-data HTTP/1.1" 200 -
2025-10-22 15:38:25,850 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:38:25,850 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:38:25.849989
2025-10-22 15:38:25,850 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:38:25,850 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:38:25.849989",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:38:25,881 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:38:25,883 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:38:25,887 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:38:25,887 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:38:25,887 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:38:25,887 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:38:25,887 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:38:25,888 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:38:25,888 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:38:25,889 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:38:27,346 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:38:27,346 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:38:27.345946
2025-10-22 15:38:27,346 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:38:27,346 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:38:27.345946",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:38:27,373 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:38:27,375 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:38:27,378 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:38:27,378 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:38:27,378 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:38:27,378 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:38:27,378 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:38:27,378 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:38:27,378 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:38:27,379 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:38:55,890 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:38:55,890 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:38:55.890049
2025-10-22 15:38:55,890 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:38:55,890 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:38:55.890049",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:38:55,920 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:38:55,921 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:38:55,925 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:38:55,926 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:38:55,926 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:38:55,926 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:38:55,926 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:38:55,926 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:38:55,926 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:38:55,927 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:38:57,380 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:38:57,380 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:38:57.380529
2025-10-22 15:38:57,381 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:38:57,381 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:38:57.380529",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:38:57,411 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:38:57,412 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:38:57,416 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:38:57,416 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:38:57,416 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:38:57,416 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:38:57,416 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:38:57,416 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:38:57,416 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:38:57,418 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:39:25,928 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:39:25,928 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:39:25.928384
2025-10-22 15:39:25,928 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:39:25,929 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:39:25.928384",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:39:25,963 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:39:25,965 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:39:25,969 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:39:25,969 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:39:25,969 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:39:25,970 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:39:25,970 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:39:25,970 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:39:25,970 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:39:25,971 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:39:27,418 - __main__ - INFO - get_todays_alerts:156 - 📊 Getting today's alerts
2025-10-22 15:39:27,418 - __main__ - INFO - get_alerts_by_time_range:145 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:39:27.418531
2025-10-22 15:39:27,418 - __main__ - DEBUG - _make_request:91 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:39:27,419 - __main__ - DEBUG - _make_request:92 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:39:27.418531",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:39:27,444 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:39:27,445 - __main__ - DEBUG - _make_request:95 - 🔍 Response status: 200
2025-10-22 15:39:27,449 - __main__ - DEBUG - _make_request:100 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:39:27,449 - __main__ - DEBUG - _make_request:104 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:39:27,449 - __main__ - DEBUG - _make_request:109 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:39:27,449 - __main__ - DEBUG - _make_request:110 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:39:27,450 - __main__ - DEBUG - _make_request:111 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:39:27,450 - root - DEBUG - process_alerts_for_dashboard:249 - 🔄 Processing alerts for dashboard
2025-10-22 15:39:27,450 - root - INFO - process_alerts_for_dashboard:263 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:39:27,451 - root - INFO - process_alerts_for_dashboard:319 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:39:32,408 - werkzeug - INFO - _log:97 -  * Detected change in '/root/B_SOC/prod_v7/server.py', reloading
2025-10-22 15:39:32,661 - werkzeug - INFO - _log:97 -  * Restarting with stat
2025-10-22 15:39:34,167 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:39:34,167 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:39:34,179 - __main__ - INFO - get_todays_alerts:161 - 📊 Getting today's alerts
2025-10-22 15:39:34,179 - __main__ - INFO - get_alerts_by_time_range:150 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:39:34.179680
2025-10-22 15:39:34,180 - __main__ - DEBUG - _make_request:96 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:39:34,180 - __main__ - DEBUG - _make_request:97 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:39:34.179680",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:39:34,180 - root - INFO - <module>:626 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:39:34,183 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:39:34,229 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:39:34,231 - __main__ - DEBUG - _make_request:100 - 🔍 Response status: 200
2025-10-22 15:39:34,235 - __main__ - DEBUG - _make_request:105 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:39:34,235 - __main__ - DEBUG - _make_request:109 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:39:34,236 - __main__ - DEBUG - _make_request:114 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:39:34,236 - __main__ - DEBUG - _make_request:115 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:39:34,236 - __main__ - DEBUG - _make_request:116 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:39:34,236 - root - DEBUG - process_alerts_for_dashboard:254 - 🔄 Processing alerts for dashboard
2025-10-22 15:39:34,237 - root - INFO - process_alerts_for_dashboard:268 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:39:34,238 - root - INFO - process_alerts_for_dashboard:324 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:39:41,790 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:39:41,790 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:39:41,802 - __main__ - INFO - get_todays_alerts:161 - 📊 Getting today's alerts
2025-10-22 15:39:41,803 - root - INFO - <module>:626 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:39:41,803 - __main__ - INFO - get_alerts_by_time_range:150 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:39:41.802739
2025-10-22 15:39:41,803 - __main__ - DEBUG - _make_request:96 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:39:41,804 - __main__ - DEBUG - _make_request:97 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:39:41.802739",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:39:41,806 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:39:41,823 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:9000
 * Running on http://10.10.192.191:9000
2025-10-22 15:39:41,824 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-10-22 15:39:41,852 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:39:41,854 - __main__ - DEBUG - _make_request:100 - 🔍 Response status: 200
2025-10-22 15:39:41,859 - __main__ - DEBUG - _make_request:105 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:39:41,859 - __main__ - DEBUG - _make_request:109 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:39:41,859 - __main__ - DEBUG - _make_request:114 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:39:41,859 - __main__ - DEBUG - _make_request:115 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:39:41,859 - __main__ - DEBUG - _make_request:116 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:39:41,859 - root - DEBUG - process_alerts_for_dashboard:254 - 🔄 Processing alerts for dashboard
2025-10-22 15:39:41,859 - root - INFO - process_alerts_for_dashboard:268 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:39:41,860 - root - INFO - process_alerts_for_dashboard:324 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:39:43,143 - __main__ - INFO - get_todays_alerts:161 - 📊 Getting today's alerts
2025-10-22 15:39:43,143 - __main__ - INFO - get_alerts_by_time_range:150 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:39:43.143567
2025-10-22 15:39:43,144 - __main__ - DEBUG - _make_request:96 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:39:43,144 - __main__ - DEBUG - _make_request:97 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:39:43.143567",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:39:43,173 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:39:43,176 - __main__ - DEBUG - _make_request:100 - 🔍 Response status: 200
2025-10-22 15:39:43,180 - __main__ - DEBUG - _make_request:105 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:39:43,181 - __main__ - DEBUG - _make_request:109 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:39:43,181 - __main__ - DEBUG - _make_request:114 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:39:43,181 - __main__ - DEBUG - _make_request:115 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:39:43,182 - __main__ - DEBUG - _make_request:116 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:39:43,182 - root - DEBUG - process_alerts_for_dashboard:254 - 🔄 Processing alerts for dashboard
2025-10-22 15:39:43,182 - root - INFO - process_alerts_for_dashboard:268 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:39:43,184 - root - INFO - process_alerts_for_dashboard:324 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:39:43,192 - werkzeug - INFO - _log:97 - 10.10.192.1 - - [22/Oct/2025 15:39:43] "GET /api/dashboard-data HTTP/1.1" 200 -
2025-10-22 15:41:40,955 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:41:40,956 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:41:40,968 - __main__ - INFO - get_todays_alerts:161 - 📊 Getting today's alerts
2025-10-22 15:41:40,968 - __main__ - INFO - get_alerts_by_time_range:150 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:41:40.968561
2025-10-22 15:41:40,969 - __main__ - DEBUG - _make_request:96 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:41:40,969 - __main__ - DEBUG - _make_request:97 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:41:40.968561",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:41:40,969 - root - INFO - <module>:626 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:41:40,972 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:41:40,993 - werkzeug - INFO - _log:97 - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:9000
 * Running on http://10.10.192.191:9000
2025-10-22 15:41:40,993 - werkzeug - INFO - _log:97 - [33mPress CTRL+C to quit[0m
2025-10-22 15:41:41,023 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:41:41,025 - __main__ - DEBUG - _make_request:100 - 🔍 Response status: 200
2025-10-22 15:41:41,030 - __main__ - DEBUG - _make_request:105 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:41:41,030 - __main__ - DEBUG - _make_request:109 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:41:41,030 - __main__ - DEBUG - _make_request:114 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:41:41,030 - __main__ - DEBUG - _make_request:115 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:41:41,030 - __main__ - DEBUG - _make_request:116 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:41:41,030 - root - DEBUG - process_alerts_for_dashboard:254 - 🔄 Processing alerts for dashboard
2025-10-22 15:41:41,030 - root - INFO - process_alerts_for_dashboard:268 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:41:41,032 - root - INFO - process_alerts_for_dashboard:324 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:42:11,032 - __main__ - INFO - get_todays_alerts:161 - 📊 Getting today's alerts
2025-10-22 15:42:11,033 - __main__ - INFO - get_alerts_by_time_range:150 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:42:11.032615
2025-10-22 15:42:11,033 - __main__ - DEBUG - _make_request:96 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:42:11,033 - __main__ - DEBUG - _make_request:97 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:42:11.032615",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:42:11,065 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:42:11,067 - __main__ - DEBUG - _make_request:100 - 🔍 Response status: 200
2025-10-22 15:42:11,072 - __main__ - DEBUG - _make_request:105 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:42:11,072 - __main__ - DEBUG - _make_request:109 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:42:11,072 - __main__ - DEBUG - _make_request:114 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:42:11,072 - __main__ - DEBUG - _make_request:115 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:42:11,073 - __main__ - DEBUG - _make_request:116 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:42:11,073 - root - DEBUG - process_alerts_for_dashboard:254 - 🔄 Processing alerts for dashboard
2025-10-22 15:42:11,073 - root - INFO - process_alerts_for_dashboard:268 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:42:11,074 - root - INFO - process_alerts_for_dashboard:324 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:42:41,074 - __main__ - INFO - get_todays_alerts:161 - 📊 Getting today's alerts
2025-10-22 15:42:41,075 - __main__ - INFO - get_alerts_by_time_range:150 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:42:41.074890
2025-10-22 15:42:41,075 - __main__ - DEBUG - _make_request:96 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:42:41,075 - __main__ - DEBUG - _make_request:97 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:42:41.074890",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:42:41,095 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:42:41,096 - __main__ - DEBUG - _make_request:100 - 🔍 Response status: 200
2025-10-22 15:42:41,100 - __main__ - DEBUG - _make_request:105 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:42:41,100 - __main__ - DEBUG - _make_request:109 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:42:41,100 - __main__ - DEBUG - _make_request:114 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:42:41,100 - __main__ - DEBUG - _make_request:115 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:42:41,100 - __main__ - DEBUG - _make_request:116 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:42:41,100 - root - DEBUG - process_alerts_for_dashboard:254 - 🔄 Processing alerts for dashboard
2025-10-22 15:42:41,100 - root - INFO - process_alerts_for_dashboard:268 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:42:41,101 - root - INFO - process_alerts_for_dashboard:324 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:43:11,101 - __main__ - INFO - get_todays_alerts:161 - 📊 Getting today's alerts
2025-10-22 15:43:11,102 - __main__ - INFO - get_alerts_by_time_range:150 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:43:11.101892
2025-10-22 15:43:11,102 - __main__ - DEBUG - _make_request:96 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:43:11,102 - __main__ - DEBUG - _make_request:97 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:43:11.101892",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:43:11,133 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:43:11,135 - __main__ - DEBUG - _make_request:100 - 🔍 Response status: 200
2025-10-22 15:43:11,139 - __main__ - DEBUG - _make_request:105 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:43:11,139 - __main__ - DEBUG - _make_request:109 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:43:11,139 - __main__ - DEBUG - _make_request:114 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:43:11,139 - __main__ - DEBUG - _make_request:115 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:43:11,140 - __main__ - DEBUG - _make_request:116 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:43:11,140 - root - DEBUG - process_alerts_for_dashboard:254 - 🔄 Processing alerts for dashboard
2025-10-22 15:43:11,140 - root - INFO - process_alerts_for_dashboard:268 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:43:11,141 - root - INFO - process_alerts_for_dashboard:324 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:43:41,142 - __main__ - INFO - get_todays_alerts:161 - 📊 Getting today's alerts
2025-10-22 15:43:41,142 - __main__ - INFO - get_alerts_by_time_range:150 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:43:41.142065
2025-10-22 15:43:41,142 - __main__ - DEBUG - _make_request:96 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:43:41,143 - __main__ - DEBUG - _make_request:97 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:43:41.142065",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:43:41,171 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:43:41,173 - __main__ - DEBUG - _make_request:100 - 🔍 Response status: 200
2025-10-22 15:43:41,177 - __main__ - DEBUG - _make_request:105 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:43:41,177 - __main__ - DEBUG - _make_request:109 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:43:41,177 - __main__ - DEBUG - _make_request:114 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:43:41,178 - __main__ - DEBUG - _make_request:115 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:43:41,178 - __main__ - DEBUG - _make_request:116 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:43:41,178 - root - DEBUG - process_alerts_for_dashboard:254 - 🔄 Processing alerts for dashboard
2025-10-22 15:43:41,178 - root - INFO - process_alerts_for_dashboard:268 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:43:41,179 - root - INFO - process_alerts_for_dashboard:324 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:44:00,076 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:44:00,076 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:44:00,088 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:44:00,089 - root - INFO - <module>:629 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:44:00,089 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:44:00.088889
2025-10-22 15:44:00,090 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:44:00,090 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:44:00.088889",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:44:00,093 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:45:11,906 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:45:11,906 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:45:11,919 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:45:11,919 - root - INFO - <module>:629 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:45:11,919 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:45:11.918978
2025-10-22 15:45:11,919 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:45:11,920 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:45:11.918978",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:45:11,923 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:45:11,980 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:45:11,983 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:45:11,988 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:45:11,988 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:45:11,988 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:45:11,988 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:45:11,988 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:45:11,988 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:45:11,989 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:45:11,990 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:45:31,543 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:45:31,543 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:45:31.543136
2025-10-22 15:45:31,543 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:45:31,543 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:45:31.543136",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:45:31,570 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:45:31,572 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:45:31,577 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:45:31,577 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:45:31,577 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:45:31,577 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:45:31,577 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:45:31,577 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:45:31,577 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:45:31,579 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:45:32,682 - root - INFO - get_fim_events:256 - 🔍 FIM events API called
2025-10-22 15:45:32,683 - root - INFO - get_fim_events:269 - 🔍 Fetching FIM events from 2025-10-21T15:45:32.683118 to 2025-10-22T15:45:32.683150
2025-10-22 15:45:32,729 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:45:32,729 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:45:32,742 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:45:32,742 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:45:32.742244
2025-10-22 15:45:32,742 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:45:32,743 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:45:32.742244",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:45:32,743 - server - INFO - get_fim_events:228 - 🔍 Getting FIM events from 2025-10-21T15:45:32.683118 to 2025-10-22T15:45:32.683150
2025-10-22 15:45:32,745 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:45:32,745 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:45:32,746 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "bool": {
      "must": [
        {
          "range": {
            "@timestamp": {
              "gte": "2025-10-21T15:45:32.683118",
              "lte": "2025-10-22T15:45:32.683150"
            }
          }
        },
        {
          "term": {
            "rule.groups": "syscheck"
          }
        }
      ]
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ]
}
2025-10-22 15:45:32,747 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (2): 127.0.0.1:9200
2025-10-22 15:45:32,777 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 164
2025-10-22 15:45:32,778 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:45:32,778 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits']
2025-10-22 15:45:32,778 - server - DEBUG - _make_request:112 - 🔍 Total hits: 0, Actual hits: 0
2025-10-22 15:45:32,778 - server - INFO - get_fim_events:235 - 🔍 FIM Query Results - Total: 0, Returned: 0
2025-10-22 15:45:32,778 - server - WARNING - get_fim_events:247 - 🔍 No FIM hits returned, but total hits > 0
2025-10-22 15:45:32,778 - root - DEBUG - process_fim_events:20 - 🔄 Processing FIM events
2025-10-22 15:45:32,778 - root - WARNING - process_fim_events:34 - ❌ No real FIM data found, generating sample data
2025-10-22 15:45:32,785 - root - INFO - process_fim_events:39 - 📋 Generated 150 sample FIM events
2025-10-22 15:45:32,785 - root - INFO - process_fim_events:44 - ✅ FIM Processing Complete: 150 events, summary: {'total_files': 10, 'total_changes': 150, 'suspicious_changes': 80, 'monitored_agents': 5, 'integrity_score': '14%', 'last_scan': '17m ago', 'total_files_trend': '+1%', 'changes_trend': '+3%', 'suspicious_trend': '+3%', 'agents_trend': '+0%', 'integrity_trend': '+0%'}
2025-10-22 15:45:32,785 - root - INFO - get_fim_events:280 - ✅ Returning FIM data: 150 events
2025-10-22 15:45:32,788 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:45:32,790 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:45:32,794 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:45:32,794 - server - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:45:32,794 - server - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:45:32,795 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:45:32,795 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:45:32,795 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:45:32,795 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:45:32,796 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:45:33,534 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:45:33,534 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:45:33.534375
2025-10-22 15:45:33,534 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:45:33,535 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:45:33.534375",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:45:33,565 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:45:33,566 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:45:33,568 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:45:33,573 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:45:33,573 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:45:33,573 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:45:33,573 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:45:33,573 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:45:33,574 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:45:33,574 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:45:33,575 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:45:33,604 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /_plugins/_anomaly_detection/detectors/_search HTTP/1.1" 200 6310
2025-10-22 15:45:33,668 - uba - INFO - get_anomaly_results:47 - 🔍 Fetching UBA anomalies with grade > 0.1
2025-10-22 15:45:33,677 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "POST /_plugins/_anomaly_detection/detectors/results/_search HTTP/1.1" 200 7096
2025-10-22 15:45:33,678 - uba - INFO - get_anomaly_results:53 - 📊 Found 6 UBA anomalies
2025-10-22 15:45:33,678 - root - DEBUG - process_anomalies_for_dashboard:82 - 🔄 Processing UBA anomalies for dashboard
2025-10-22 15:45:33,679 - root - INFO - process_anomalies_for_dashboard:91 - 🔄 Processing 6 UBA anomalies
2025-10-22 15:45:33,679 - root - INFO - process_anomalies_for_dashboard:132 - ✅ Processed 6 UBA anomalies
2025-10-22 15:45:34,812 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:45:34,812 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:45:34.812540
2025-10-22 15:45:34,813 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:45:34,813 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:45:34.812540",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:45:34,848 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:45:34,850 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:45:34,854 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:45:34,855 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:45:34,855 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:45:34,855 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:45:34,855 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:45:34,855 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:45:34,855 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:45:34,856 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:45:41,990 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:45:41,991 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:45:41.990842
2025-10-22 15:45:41,991 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:45:41,991 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:45:41.990842",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:45:42,015 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:45:42,017 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:45:42,021 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:45:42,022 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:45:42,022 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:45:42,022 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:45:42,022 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:45:42,022 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:45:42,022 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:45:42,023 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:46:02,797 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:46:02,797 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:46:02.797139
2025-10-22 15:46:02,797 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:46:02,798 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:46:02.797139",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:46:02,827 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:46:02,828 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:46:02,833 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:46:02,833 - server - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:46:02,833 - server - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:46:02,834 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:46:02,834 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:46:02,834 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:46:02,834 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:46:02,837 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:46:06,014 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:46:06,014 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:46:06.014344
2025-10-22 15:46:06,014 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:46:06,015 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:46:06.014344",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:46:06,042 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:46:06,044 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:46:06,048 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:46:06,049 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:46:06,049 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:46:06,049 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:46:06,049 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:46:06,049 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:46:06,049 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:46:06,050 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:46:12,024 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:46:12,024 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:46:12.024311
2025-10-22 15:46:12,024 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:46:12,025 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:46:12.024311",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:46:12,049 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:46:12,051 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:46:12,055 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:46:12,055 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:46:12,055 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:46:12,055 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:46:12,056 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:46:12,056 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:46:12,056 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:46:12,057 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:46:32,837 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:46:32,838 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:46:32.837869
2025-10-22 15:46:32,838 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:46:32,838 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:46:32.837869",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:46:32,871 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:46:32,873 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:46:32,877 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:46:32,877 - server - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:46:32,877 - server - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:46:32,877 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:46:32,877 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:46:32,878 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:46:32,878 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:46:32,879 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:46:36,015 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:46:36,015 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:46:36.015299
2025-10-22 15:46:36,015 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:46:36,016 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:46:36.015299",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:46:36,043 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:46:36,044 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:46:36,049 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:46:36,049 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:46:36,049 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:46:36,049 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:46:36,049 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:46:36,049 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:46:36,049 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:46:36,051 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:46:42,057 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:46:42,058 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:46:42.057933
2025-10-22 15:46:42,058 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:46:42,058 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:46:42.057933",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:46:42,086 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 120908
2025-10-22 15:46:42,088 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:46:42,092 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:46:42,092 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 75, Actual hits: 75
2025-10-22 15:46:42,092 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: 6Ho7C5oBnysS8cfeOHYw
2025-10-22 15:46:42,093 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:23:30.943Z
2025-10-22 15:46:42,093 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog', 'authentication_success']
2025-10-22 15:46:42,093 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:46:42,093 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 75 total alerts, 75 returned
2025-10-22 15:46:42,094 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 75 alerts for dashboard
2025-10-22 15:47:02,879 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:47:02,880 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:47:02.879903
2025-10-22 15:47:02,880 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:47:02,880 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:47:02.879903",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:47:02,909 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:47:02,911 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:47:02,915 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:47:02,916 - server - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:47:02,916 - server - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:47:02,916 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:47:02,916 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:47:02,916 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:47:02,916 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:47:02,917 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:47:06,014 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:47:06,014 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:47:06.014101
2025-10-22 15:47:06,014 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:47:06,014 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:47:06.014101",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:47:06,041 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:47:06,042 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:47:06,047 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:47:06,047 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:47:06,047 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:47:06,047 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:47:06,047 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:47:06,047 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:47:06,047 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:47:06,048 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:47:12,095 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:47:12,095 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:47:12.095280
2025-10-22 15:47:12,095 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:47:12,096 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:47:12.095280",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:47:12,121 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:47:12,123 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:47:12,132 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:47:12,132 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:47:12,133 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:47:12,133 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:47:12,133 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:47:12,133 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:47:12,133 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:47:12,134 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:47:32,918 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:47:32,918 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:47:32.918633
2025-10-22 15:47:32,919 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:47:32,919 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:47:32.918633",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:47:32,945 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:47:32,946 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:47:32,951 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:47:32,951 - server - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:47:32,951 - server - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:47:32,951 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:47:32,951 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:47:32,951 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:47:32,952 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:47:32,953 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:47:36,015 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:47:36,016 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:47:36.015895
2025-10-22 15:47:36,016 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:47:36,016 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:47:36.015895",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:47:36,044 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:47:36,047 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:47:36,051 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:47:36,051 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:47:36,052 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:47:36,052 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:47:36,052 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:47:36,052 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:47:36,052 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:47:36,053 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:47:42,135 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:47:42,135 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:47:42.135214
2025-10-22 15:47:42,135 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:47:42,136 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:47:42.135214",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:47:42,161 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:47:42,162 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:47:42,166 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:47:42,166 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:47:42,166 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:47:42,167 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:47:42,167 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:47:42,167 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:47:42,167 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:47:42,168 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:48:02,953 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:48:02,954 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:48:02.953734
2025-10-22 15:48:02,954 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:48:02,954 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:48:02.953734",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:48:02,977 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:48:02,978 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:48:02,982 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:48:02,983 - server - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:48:02,983 - server - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:48:02,983 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:48:02,983 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:48:02,983 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:48:02,983 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:48:02,984 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:48:06,897 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:48:06,897 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:48:06.897627
2025-10-22 15:48:06,898 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:48:06,898 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:48:06.897627",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:48:06,923 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:48:06,925 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:48:06,929 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:48:06,929 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:48:06,929 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:48:06,929 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:48:06,929 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:48:06,929 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:48:06,929 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:48:06,931 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:48:12,169 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:48:12,169 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:48:12.169156
2025-10-22 15:48:12,169 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:48:12,170 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:48:12.169156",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:48:12,196 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:48:12,198 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:48:12,202 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:48:12,202 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:48:12,202 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:48:12,202 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:48:12,202 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:48:12,202 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:48:12,203 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:48:12,204 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:48:32,985 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:48:32,985 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:48:32.985282
2025-10-22 15:48:32,985 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:48:32,986 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:48:32.985282",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:48:33,012 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:48:33,014 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:48:33,018 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:48:33,018 - server - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:48:33,018 - server - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:48:33,019 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:48:33,019 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:48:33,019 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:48:33,019 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:48:33,020 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:48:36,896 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:48:36,897 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:48:36.896833
2025-10-22 15:48:36,897 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:48:36,897 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:48:36.896833",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:48:36,925 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:48:36,926 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:48:36,931 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:48:36,932 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:48:36,932 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:48:36,932 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:48:36,932 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:48:36,933 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:48:36,933 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:48:36,934 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:48:42,204 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:48:42,205 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:48:42.204913
2025-10-22 15:48:42,205 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:48:42,205 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:48:42.204913",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:48:42,232 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:48:42,233 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:48:42,237 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:48:42,238 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:48:42,238 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:48:42,238 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:48:42,238 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:48:42,238 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:48:42,238 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:48:42,240 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:49:03,021 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:49:03,021 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:49:03.021334
2025-10-22 15:49:03,021 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:49:03,022 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:49:03.021334",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:49:03,047 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:49:03,048 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:49:03,052 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:49:03,053 - server - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:49:03,053 - server - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:49:03,053 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:49:03,053 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:49:03,053 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:49:03,053 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:49:03,054 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:49:12,240 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:49:12,241 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:49:12.240790
2025-10-22 15:49:12,241 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:49:12,241 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:49:12.240790",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:49:12,268 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:49:12,270 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:49:12,274 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:49:12,274 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:49:12,274 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:49:12,274 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:49:12,274 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:49:12,275 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:49:12,275 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:49:12,276 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:49:33,055 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:49:33,055 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:49:33.055321
2025-10-22 15:49:33,055 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:49:33,056 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:49:33.055321",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:49:33,088 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:49:33,089 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:49:33,099 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:49:33,099 - server - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:49:33,099 - server - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:49:33,099 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:49:33,099 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:49:33,099 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:49:33,099 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:49:33,101 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:49:42,276 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:49:42,277 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:49:42.276912
2025-10-22 15:49:42,277 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:49:42,277 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:49:42.276912",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:49:42,304 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:49:42,306 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:49:42,311 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:49:42,312 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:49:42,312 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:49:42,312 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:49:42,312 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:49:42,312 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:49:42,312 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:49:42,313 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:50:03,101 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:50:03,102 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:50:03.101690
2025-10-22 15:50:03,102 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:50:03,102 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:50:03.101690",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:50:03,129 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:50:03,131 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:50:03,135 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:50:03,136 - server - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:50:03,136 - server - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:50:03,136 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:50:03,136 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:50:03,136 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:50:03,136 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:50:03,137 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:50:12,314 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:50:12,315 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:50:12.314717
2025-10-22 15:50:12,315 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:50:12,316 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:50:12.314717",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:50:12,345 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:50:12,348 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:50:12,357 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:50:12,357 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:50:12,357 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:50:12,357 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:50:12,358 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:50:12,358 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:50:12,358 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:50:12,361 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:50:33,138 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:50:33,138 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:50:33.138574
2025-10-22 15:50:33,139 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:50:33,139 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:50:33.138574",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:50:33,164 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:50:33,167 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:50:33,172 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:50:33,173 - server - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:50:33,173 - server - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:50:33,173 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:50:33,173 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:50:33,173 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:50:33,173 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:50:33,174 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:50:42,362 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:50:42,362 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:50:42.362175
2025-10-22 15:50:42,362 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:50:42,363 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:50:42.362175",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:50:42,395 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:50:42,397 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:50:42,401 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:50:42,401 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:50:42,401 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:50:42,401 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:50:42,401 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:50:42,401 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:50:42,401 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:50:42,404 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:50:57,346 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:50:57,346 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:50:57.346597
2025-10-22 15:50:57,347 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:50:57,347 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:50:57.346597",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:50:57,381 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:50:57,382 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:50:57,387 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:50:57,387 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:50:57,387 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:50:57,387 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:50:57,387 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:50:57,387 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:50:57,387 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:50:57,389 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:51:03,175 - server - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:51:03,175 - server - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:51:03.175325
2025-10-22 15:51:03,175 - server - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:51:03,176 - server - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:51:03.175325",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:51:03,212 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:51:03,213 - server - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:51:03,217 - server - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:51:03,218 - server - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:51:03,218 - server - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:51:03,218 - server - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:51:03,218 - server - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:51:03,218 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:51:03,218 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:51:03,219 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:51:07,684 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 15:51:07,684 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 15:51:07,696 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:51:07,696 - root - INFO - <module>:629 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 15:51:07,697 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:51:07.696528
2025-10-22 15:51:07,697 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:51:07,698 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:51:07.696528",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:51:07,701 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 15:51:07,750 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:51:07,752 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:51:07,757 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:51:07,757 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:51:07,757 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:51:07,757 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:51:07,757 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:51:07,757 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:51:07,758 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:51:07,759 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:51:37,760 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:51:37,760 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:51:37.759994
2025-10-22 15:51:37,760 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:51:37,761 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:51:37.759994",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:51:37,791 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:51:37,793 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:51:37,797 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:51:37,798 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:51:37,798 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:51:37,798 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:51:37,798 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:51:37,798 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:51:37,798 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:51:37,799 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:52:07,800 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:52:07,800 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:52:07.800507
2025-10-22 15:52:07,800 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:52:07,801 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:52:07.800507",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:52:07,827 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:52:07,828 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:52:07,832 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:52:07,832 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:52:07,832 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:52:07,832 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:52:07,832 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:52:07,833 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:52:07,833 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:52:07,834 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:52:27,544 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:52:27,544 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:52:27.544326
2025-10-22 15:52:27,544 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:52:27,545 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:52:27.544326",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:52:27,570 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:52:27,572 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:52:27,576 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:52:27,576 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:52:27,577 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:52:27,577 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:52:27,577 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:52:27,577 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:52:27,577 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:52:27,578 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:52:37,834 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:52:37,835 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:52:37.834885
2025-10-22 15:52:37,835 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:52:37,835 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:52:37.834885",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:52:37,864 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:52:37,865 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:52:37,870 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:52:37,870 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:52:37,870 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:52:37,870 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:52:37,870 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:52:37,870 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:52:37,870 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:52:37,872 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:53:07,872 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:53:07,873 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:53:07.872755
2025-10-22 15:53:07,873 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:53:07,873 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:53:07.872755",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:53:07,894 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:53:07,896 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:53:07,899 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:53:07,899 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:53:07,899 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:53:07,900 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:53:07,900 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:53:07,900 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:53:07,900 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:53:07,902 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:53:37,903 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:53:37,904 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:53:37.903608
2025-10-22 15:53:37,904 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:53:37,904 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:53:37.903608",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:53:37,937 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:53:37,939 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:53:37,943 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:53:37,943 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:53:37,943 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:53:37,943 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:53:37,944 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:53:37,944 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:53:37,944 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:53:37,945 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:53:57,534 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:53:57,535 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:53:57.534847
2025-10-22 15:53:57,535 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:53:57,535 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:53:57.534847",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:53:57,559 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:53:57,561 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:53:57,564 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:53:57,564 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:53:57,565 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:53:57,565 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:53:57,565 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:53:57,565 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:53:57,565 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:53:57,566 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:54:07,946 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:54:07,946 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:54:07.946082
2025-10-22 15:54:07,946 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:54:07,947 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:54:07.946082",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:54:07,974 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:54:07,975 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:54:07,983 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:54:07,983 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:54:07,983 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:54:07,983 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:54:07,983 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:54:07,984 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:54:07,984 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:54:07,985 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:54:37,986 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:54:37,986 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:54:37.985952
2025-10-22 15:54:37,986 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:54:37,987 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:54:37.985952",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:54:38,019 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:54:38,021 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:54:38,025 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:54:38,025 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:54:38,025 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:54:38,025 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:54:38,025 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:54:38,026 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:54:38,026 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:54:38,027 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:55:08,028 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:55:08,028 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:55:08.028067
2025-10-22 15:55:08,028 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:55:08,029 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:55:08.028067",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:55:08,057 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:55:08,059 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:55:08,063 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:55:08,063 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:55:08,063 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:55:08,063 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:55:08,064 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:55:08,064 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:55:08,064 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:55:08,065 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:55:28,422 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:55:28,423 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:55:28.422671
2025-10-22 15:55:28,423 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:55:28,423 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:55:28.422671",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:55:28,450 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:55:28,452 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:55:28,456 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:55:28,456 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:55:28,456 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:55:28,456 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:55:28,456 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:55:28,456 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:55:28,456 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:55:28,458 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:55:38,066 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:55:38,066 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:55:38.066039
2025-10-22 15:55:38,066 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:55:38,066 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:55:38.066039",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:55:38,094 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:55:38,096 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:55:38,100 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:55:38,100 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:55:38,100 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:55:38,100 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:55:38,100 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:55:38,100 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:55:38,100 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:55:38,102 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:56:08,102 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:56:08,103 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:56:08.102753
2025-10-22 15:56:08,103 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:56:08,103 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:56:08.102753",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:56:08,136 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:56:08,138 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:56:08,142 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:56:08,142 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:56:08,142 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:56:08,142 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:56:08,142 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:56:08,143 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:56:08,143 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:56:08,144 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:56:38,144 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:56:38,145 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:56:38.144835
2025-10-22 15:56:38,145 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:56:38,145 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:56:38.144835",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:56:38,176 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:56:38,178 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:56:38,182 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:56:38,182 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:56:38,182 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:56:38,183 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:56:38,183 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:56:38,183 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:56:38,183 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:56:38,184 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:56:58,434 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:56:58,434 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:56:58.434102
2025-10-22 15:56:58,434 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:56:58,434 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:56:58.434102",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:56:58,463 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:56:58,464 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:56:58,468 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:56:58,469 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:56:58,469 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:56:58,469 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:56:58,469 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:56:58,469 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:56:58,469 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:56:58,470 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:57:08,185 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:57:08,185 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:57:08.185018
2025-10-22 15:57:08,185 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:57:08,185 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:57:08.185018",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:57:08,209 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:57:08,211 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:57:08,214 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:57:08,215 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:57:08,215 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:57:08,215 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:57:08,215 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:57:08,215 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:57:08,215 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:57:08,216 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:57:38,217 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:57:38,218 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:57:38.217662
2025-10-22 15:57:38,218 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:57:38,218 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:57:38.217662",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:57:38,246 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:57:38,248 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:57:38,252 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:57:38,252 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:57:38,252 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:57:38,252 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:57:38,252 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:57:38,252 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:57:38,252 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:57:38,253 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:58:08,254 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:58:08,254 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:58:08.254577
2025-10-22 15:58:08,255 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:58:08,255 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:58:08.254577",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:58:08,277 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:58:08,279 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:58:08,283 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:58:08,283 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:58:08,283 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:58:08,283 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:58:08,283 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:58:08,283 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:58:08,283 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:58:08,285 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:58:28,986 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:58:28,987 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:58:28.986687
2025-10-22 15:58:28,987 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:58:28,987 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:58:28.986687",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:58:29,012 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:58:29,013 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:58:29,017 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:58:29,017 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:58:29,017 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:58:29,017 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:58:29,017 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:58:29,018 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:58:29,018 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:58:29,019 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:58:38,285 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:58:38,285 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:58:38.285575
2025-10-22 15:58:38,286 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:58:38,286 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:58:38.285575",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:58:38,314 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:58:38,315 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:58:38,324 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:58:38,324 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:58:38,324 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:58:38,324 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:58:38,324 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:58:38,325 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:58:38,325 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:58:38,326 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:59:08,326 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:59:08,327 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:59:08.326919
2025-10-22 15:59:08,327 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:59:08,327 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:59:08.326919",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:59:08,353 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:59:08,355 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:59:08,361 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:59:08,362 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:59:08,362 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:59:08,362 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:59:08,362 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:59:08,362 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:59:08,362 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:59:08,364 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:59:38,365 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:59:38,365 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:59:38.365583
2025-10-22 15:59:38,366 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:59:38,366 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:59:38.365583",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:59:38,392 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:59:38,393 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:59:38,397 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:59:38,397 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:59:38,397 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:59:38,397 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:59:38,398 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:59:38,398 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:59:38,398 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:59:38,400 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 15:59:59,762 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 15:59:59,763 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T15:59:59.762754
2025-10-22 15:59:59,763 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 15:59:59,763 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T15:59:59.762754",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 15:59:59,790 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 15:59:59,792 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 15:59:59,796 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 15:59:59,796 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 15:59:59,796 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 15:59:59,796 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 15:59:59,796 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 15:59:59,796 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 15:59:59,796 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 15:59:59,798 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:00:08,401 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 16:00:08,401 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:00:08.401201
2025-10-22 16:00:08,401 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:00:08,402 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:00:08.401201",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:00:08,428 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:00:08,430 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 16:00:08,434 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:00:08,434 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:00:08,434 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:00:08,434 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:00:08,435 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:00:08,435 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 16:00:08,435 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:00:08,436 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:00:38,437 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 16:00:38,437 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:00:38.437221
2025-10-22 16:00:38,437 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:00:38,438 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:00:38.437221",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:00:38,469 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:00:38,470 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 16:00:38,474 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:00:38,474 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:00:38,474 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:00:38,474 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:00:38,474 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:00:38,475 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 16:00:38,475 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:00:38,476 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:01:08,477 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 16:01:08,477 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:01:08.476958
2025-10-22 16:01:08,477 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:01:08,477 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:01:08.476958",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:01:08,503 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:01:08,505 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 16:01:08,509 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:01:08,509 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:01:08,509 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:01:08,509 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:01:08,509 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:01:08,509 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 16:01:08,510 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:01:08,511 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:01:30,138 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 16:01:30,139 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:01:30.138817
2025-10-22 16:01:30,139 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:01:30,139 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:01:30.138817",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:01:30,166 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:01:30,167 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 16:01:30,171 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:01:30,171 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:01:30,171 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:01:30,171 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:01:30,172 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:01:30,172 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 16:01:30,172 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:01:30,173 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:01:38,511 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 16:01:38,512 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:01:38.511801
2025-10-22 16:01:38,512 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:01:38,512 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:01:38.511801",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:01:38,540 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:01:38,542 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 16:01:38,546 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:01:38,546 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:01:38,546 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:01:38,546 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:01:38,546 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:01:38,547 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 16:01:38,547 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:01:38,548 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:02:08,549 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 16:02:08,549 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:02:08.548987
2025-10-22 16:02:08,549 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:02:08,549 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:02:08.548987",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:02:08,576 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:02:08,577 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 16:02:08,581 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:02:08,582 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:02:08,582 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:02:08,582 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:02:08,582 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:02:08,582 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 16:02:08,582 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:02:08,583 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:02:38,584 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 16:02:38,584 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:02:38.584557
2025-10-22 16:02:38,585 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:02:38,585 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:02:38.584557",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:02:38,608 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:02:38,609 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 16:02:38,613 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:02:38,614 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:02:38,614 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:02:38,614 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:02:38,614 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:02:38,614 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 16:02:38,614 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:02:38,615 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:03:00,313 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 16:03:00,313 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:03:00.313001
2025-10-22 16:03:00,313 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:03:00,313 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:03:00.313001",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:03:00,350 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:03:00,352 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 16:03:00,356 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:03:00,356 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:03:00,356 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:03:00,357 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:03:00,357 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:03:00,357 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 16:03:00,357 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:03:00,358 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:03:08,616 - __main__ - INFO - get_todays_alerts:164 - 📊 Getting today's alerts
2025-10-22 16:03:08,616 - __main__ - INFO - get_alerts_by_time_range:153 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:03:08.616360
2025-10-22 16:03:08,616 - __main__ - DEBUG - _make_request:99 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:03:08,617 - __main__ - DEBUG - _make_request:100 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:03:08.616360",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:03:08,640 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:03:08,641 - __main__ - DEBUG - _make_request:103 - 🔍 Response status: 200
2025-10-22 16:03:08,652 - __main__ - DEBUG - _make_request:108 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:03:08,652 - __main__ - DEBUG - _make_request:112 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:03:08,652 - __main__ - DEBUG - _make_request:117 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:03:08,652 - __main__ - DEBUG - _make_request:118 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:03:08,652 - __main__ - DEBUG - _make_request:119 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:03:08,652 - root - DEBUG - process_alerts_for_dashboard:257 - 🔄 Processing alerts for dashboard
2025-10-22 16:03:08,652 - root - INFO - process_alerts_for_dashboard:271 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:03:08,653 - root - INFO - process_alerts_for_dashboard:327 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:03:33,332 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 16:03:33,333 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 16:03:33,346 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:03:33,346 - root - INFO - <module>:646 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 16:03:33,346 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:03:33.346027
2025-10-22 16:03:33,347 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:03:33,347 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:03:33.346027",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:03:33,350 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:03:33,396 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:03:33,401 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:03:33,406 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:03:33,406 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:03:33,406 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:03:33,406 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:03:33,407 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:03:33,407 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:03:33,407 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:03:33,408 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:03:37,238 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:03:41,019 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:03:46,236 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:03:56,278 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:04:03,409 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:04:03,409 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:04:03.409127
2025-10-22 16:04:03,409 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:04:03,410 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:04:03.409127",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:04:03,437 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:04:03,439 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:04:03,443 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:04:03,443 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:04:03,443 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:04:03,443 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:04:03,443 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:04:03,443 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:04:03,443 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:04:03,445 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:04:32,416 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 16:04:32,417 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 16:04:32,429 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:04:32,430 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:04:32.429719
2025-10-22 16:04:32,430 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:04:32,430 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:04:32.429719",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:04:32,430 - root - INFO - <module>:646 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 16:04:32,433 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:04:32,478 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:04:32,480 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:04:32,484 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:04:32,485 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:04:32,485 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:04:32,485 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:04:32,485 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:04:32,485 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:04:32,485 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:04:32,486 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:04:59,426 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:05:02,487 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:05:02,487 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:05:02.487498
2025-10-22 16:05:02,487 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:05:02,488 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:05:02.487498",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:05:02,517 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:05:02,518 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:05:02,522 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:05:02,522 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:05:02,523 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:05:02,523 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:05:02,523 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:05:02,523 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:05:02,523 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:05:02,524 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:05:03,927 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:05:04,650 - root - INFO - get_fim_events:256 - 🔍 FIM events API called
2025-10-22 16:05:04,651 - root - INFO - get_fim_events:269 - 🔍 Fetching FIM events from 2025-10-21T16:05:04.651176 to 2025-10-22T16:05:04.651220
2025-10-22 16:05:04,717 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 16:05:04,717 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 16:05:04,729 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:05:04,729 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:05:04.729440
2025-10-22 16:05:04,729 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:05:04,730 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:05:04.729440",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:05:04,730 - server - INFO - get_fim_events:245 - 🔍 Getting FIM events from 2025-10-21T16:05:04.651176 to 2025-10-22T16:05:04.651220
2025-10-22 16:05:04,735 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:05:04,735 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:05:04,736 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "bool": {
      "must": [
        {
          "range": {
            "@timestamp": {
              "gte": "2025-10-21T16:05:04.651176",
              "lte": "2025-10-22T16:05:04.651220"
            }
          }
        },
        {
          "term": {
            "rule.groups": "syscheck"
          }
        }
      ]
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ]
}
2025-10-22 16:05:04,737 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (2): 127.0.0.1:9200
2025-10-22 16:05:04,769 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 164
2025-10-22 16:05:04,770 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:05:04,770 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits']
2025-10-22 16:05:04,770 - server - DEBUG - _make_request:129 - 🔍 Total hits: 0, Actual hits: 0
2025-10-22 16:05:04,771 - server - INFO - get_fim_events:252 - 🔍 FIM Query Results - Total: 0, Returned: 0
2025-10-22 16:05:04,771 - server - WARNING - get_fim_events:264 - 🔍 No FIM hits returned, but total hits > 0
2025-10-22 16:05:04,771 - root - DEBUG - process_fim_events:20 - 🔄 Processing FIM events
2025-10-22 16:05:04,771 - root - WARNING - process_fim_events:34 - ❌ No real FIM data found, generating sample data
2025-10-22 16:05:04,777 - root - INFO - process_fim_events:39 - 📋 Generated 150 sample FIM events
2025-10-22 16:05:04,777 - root - INFO - process_fim_events:44 - ✅ FIM Processing Complete: 150 events, summary: {'total_files': 10, 'total_changes': 150, 'suspicious_changes': 79, 'monitored_agents': 5, 'integrity_score': '14%', 'last_scan': '20m ago', 'total_files_trend': '+0%', 'changes_trend': '+9%', 'suspicious_trend': '+8%', 'agents_trend': '+0%', 'integrity_trend': '+0%'}
2025-10-22 16:05:04,778 - root - INFO - get_fim_events:280 - ✅ Returning FIM data: 150 events
2025-10-22 16:05:04,781 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:05:04,783 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /_cluster/health HTTP/1.1" 401 12
2025-10-22 16:05:04,785 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:05:04,789 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:05:04,789 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:05:04,789 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:05:04,790 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:05:04,790 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:05:04,790 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:05:04,790 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:05:04,792 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:05:08,485 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:05:08,506 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:05:08,536 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /_plugins/_anomaly_detection/detectors/_search HTTP/1.1" 200 6310
2025-10-22 16:05:08,556 - uba - INFO - get_anomaly_results:47 - 🔍 Fetching UBA anomalies with grade > 0.1
2025-10-22 16:05:08,566 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "POST /_plugins/_anomaly_detection/detectors/results/_search HTTP/1.1" 200 7096
2025-10-22 16:05:08,567 - uba - INFO - get_anomaly_results:53 - 📊 Found 6 UBA anomalies
2025-10-22 16:05:08,567 - root - DEBUG - process_anomalies_for_dashboard:82 - 🔄 Processing UBA anomalies for dashboard
2025-10-22 16:05:08,567 - root - INFO - process_anomalies_for_dashboard:91 - 🔄 Processing 6 UBA anomalies
2025-10-22 16:05:08,568 - root - INFO - process_anomalies_for_dashboard:132 - ✅ Processed 6 UBA anomalies
2025-10-22 16:05:13,526 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:05:14,109 - threat_intel - INFO - get_threat_alerts:94 - 🔍 Querying threat alerts from 2025-10-21T16:05:14.109384 to 2025-10-22T16:05:14.109384
2025-10-22 16:05:14,109 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-*/_search
2025-10-22 16:05:14,110 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "bool": {
      "must": [
        {
          "terms": {
            "rule.groups": [
              "misp",
              "misp_alert"
            ]
          }
        },
        {
          "exists": {
            "field": "data.misp"
          }
        }
      ],
      "must_not": [
        {
          "wildcard": {
            "rule.description": "*Error*"
          }
        },
        {
          "wildcard": {
            "rule.description": "*error*"
          }
        }
      ],
      "filter": [
        {
          "range": {
            "timestamp": {
              "gte": "2025-10-21T16:05:14.109384",
              "lte": "2025-10-22T16:05:14.109384"
            }
          }
        }
      ]
    }
  },
  "size": 1000,
  "sort": [
    {
      "timestamp": {
        "order": "desc"
      }
    }
  ],
  "_source": [
    "timestamp",
    "agent",
    "manager",
    "rule",
    "data.misp",
    "location",
    "decoder"
  ]
}
2025-10-22 16:05:14,133 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-*/_search HTTP/1.1" 200 164
2025-10-22 16:05:14,133 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:05:14,134 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits']
2025-10-22 16:05:14,134 - server - DEBUG - _make_request:129 - 🔍 Total hits: 0, Actual hits: 0
2025-10-22 16:05:18,155 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 10.10.192.205:9443
2025-10-22 16:05:18,157 - threat_intel - ERROR - _test_misp_connection:309 - ❌ MISP connection test failed: HTTPSConnectionPool(host='10.10.192.205', port=9443): Max retries exceeded with url: /events?limit=1 (Caused by NewConnectionError('<urllib3.connection.HTTPSConnection object at 0x7efdf41d2420>: Failed to establish a new connection: [Errno 113] No route to host'))
2025-10-22 16:05:18,157 - threat_intel - ERROR - get_threat_feeds:226 - ❌ MISP connection test failed
2025-10-22 16:05:19,361 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:05:19,393 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "POST /wazuh-states-vulnerabilities-*/_search HTTP/1.1" 200 845842
2025-10-22 16:05:19,487 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:05:19,513 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "POST /wazuh-states-vulnerabilities-*/_search HTTP/1.1" 200 53532
2025-10-22 16:05:21,137 - root - INFO - get_case_summary:291 - 📊 Fetching case management summary from IRIS
2025-10-22 16:05:21,138 - case_management - DEBUG - _make_request:42 - 🔍 Making GET request to: https://10.10.192.205:4433/manage/cases/list
2025-10-22 16:05:21,139 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 10.10.192.205:4433
2025-10-22 16:05:21,190 - urllib3.connectionpool - DEBUG - _make_request:544 - https://10.10.192.205:4433 "GET /manage/cases/list?page=1&per_page=100 HTTP/1.1" 200 1935
2025-10-22 16:05:21,191 - case_management - DEBUG - _make_request:66 - 🔍 Response status: 200
2025-10-22 16:05:21,191 - root - INFO - get_case_summary:296 - 🔍 Cases response type: <class 'dict'>
2025-10-22 16:05:21,191 - root - INFO - process_cases_summary:174 - 📊 Processing 4 cases from IRIS
2025-10-22 16:05:21,232 - root - INFO - get_cases:316 - 📊 Fetching cases from IRIS
2025-10-22 16:05:21,232 - case_management - DEBUG - _make_request:42 - 🔍 Making GET request to: https://10.10.192.205:4433/manage/cases/list
2025-10-22 16:05:21,264 - urllib3.connectionpool - DEBUG - _make_request:544 - https://10.10.192.205:4433 "GET /manage/cases/list?page=1&per_page=25 HTTP/1.1" 200 1935
2025-10-22 16:05:21,265 - case_management - DEBUG - _make_request:66 - 🔍 Response status: 200
2025-10-22 16:05:21,265 - root - INFO - get_cases:326 - 📋 Extracted 4 cases from IRIS response
2025-10-22 16:05:21,297 - case_management - DEBUG - _make_request:42 - 🔍 Making GET request to: https://10.10.192.205:4433/manage/cases/list
2025-10-22 16:05:21,330 - urllib3.connectionpool - DEBUG - _make_request:544 - https://10.10.192.205:4433 "GET /manage/cases/list?page=1&per_page=1 HTTP/1.1" 200 1935
2025-10-22 16:05:21,330 - case_management - DEBUG - _make_request:66 - 🔍 Response status: 200
2025-10-22 16:05:23,201 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:05:28,290 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:05:32,525 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:05:32,526 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:05:32.525544
2025-10-22 16:05:32,526 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:05:32,526 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:05:32.525544",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:05:32,565 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:05:32,567 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:05:32,570 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:05:32,570 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:05:32,570 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:05:32,570 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:05:32,571 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:05:32,571 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:05:32,571 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:05:32,572 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:05:34,792 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:05:34,792 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:05:34.792539
2025-10-22 16:05:34,793 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:05:34,793 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:05:34.792539",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:05:34,830 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:05:34,831 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:05:34,834 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:05:34,834 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:05:34,835 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:05:34,835 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:05:34,835 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:05:34,835 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:05:34,835 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:05:34,836 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:05:38,667 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:06:02,572 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:06:02,573 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:06:02.572849
2025-10-22 16:06:02,573 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:06:02,573 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:06:02.572849",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:06:02,602 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:06:02,603 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:06:02,607 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:06:02,607 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:06:02,607 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:06:02,607 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:06:02,607 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:06:02,607 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:06:02,607 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:06:02,608 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:06:04,837 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:06:04,837 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:06:04.837219
2025-10-22 16:06:04,837 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:06:04,838 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:06:04.837219",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:06:04,864 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:06:04,866 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:06:04,869 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:06:04,869 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:06:04,869 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:06:04,869 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:06:04,869 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:06:04,869 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:06:04,870 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:06:04,871 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:06:27,462 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:06:29,020 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:06:32,609 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:06:32,609 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:06:32.609608
2025-10-22 16:06:32,610 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:06:32,610 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:06:32.609608",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:06:32,638 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:06:32,640 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:06:32,644 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:06:32,644 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:06:32,644 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:06:32,644 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:06:32,644 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:06:32,645 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:06:32,645 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:06:32,646 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:06:34,041 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:06:34,871 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:06:34,872 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:06:34.871672
2025-10-22 16:06:34,872 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:06:34,872 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:06:34.871672",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:06:34,901 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:06:34,903 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:06:34,907 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:06:34,907 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:06:34,907 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:06:34,907 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:06:34,907 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:06:34,907 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:06:34,907 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:06:34,909 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:06:44,082 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:07:02,647 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:07:02,647 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:07:02.646972
2025-10-22 16:07:02,647 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:07:02,647 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:07:02.646972",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:07:02,673 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:07:02,674 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:07:02,678 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:07:02,678 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:07:02,678 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:07:02,678 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:07:02,678 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:07:02,679 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:07:02,679 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:07:02,680 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:07:04,909 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:07:04,910 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:07:04.909673
2025-10-22 16:07:04,910 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:07:04,910 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:07:04.909673",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:07:04,943 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:07:04,944 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:07:04,951 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:07:04,951 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:07:04,951 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:07:04,951 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:07:04,952 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:07:04,952 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:07:04,952 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:07:04,953 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:07:32,680 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:07:32,681 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:07:32.680938
2025-10-22 16:07:32,681 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:07:32,681 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:07:32.680938",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:07:32,713 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:07:32,714 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:07:32,718 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:07:32,718 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:07:32,718 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:07:32,718 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:07:32,718 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:07:32,718 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:07:32,719 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:07:32,720 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:07:34,954 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:07:34,954 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:07:34.954593
2025-10-22 16:07:34,955 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:07:34,955 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:07:34.954593",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:07:34,983 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:07:34,984 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:07:34,988 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:07:34,988 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:07:34,988 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:07:34,989 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:07:34,989 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:07:34,989 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:07:34,989 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:07:34,990 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:08:02,720 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:08:02,721 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:08:02.720774
2025-10-22 16:08:02,721 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:08:02,721 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:08:02.720774",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:08:02,749 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:08:02,751 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:08:02,755 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:08:02,755 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:08:02,755 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:08:02,755 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:08:02,756 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:08:02,756 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:08:02,756 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:08:02,758 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:08:04,991 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:08:04,991 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:08:04.991180
2025-10-22 16:08:04,991 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:08:04,992 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:08:04.991180",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:08:05,020 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:08:05,021 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:08:05,025 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:08:05,025 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:08:05,025 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:08:05,026 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:08:05,026 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:08:05,026 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:08:05,026 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:08:05,027 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:08:32,759 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:08:32,759 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:08:32.759368
2025-10-22 16:08:32,759 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:08:32,760 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:08:32.759368",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:08:32,787 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:08:32,789 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:08:32,793 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:08:32,793 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:08:32,793 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:08:32,793 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:08:32,793 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:08:32,793 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:08:32,794 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:08:32,795 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:08:35,028 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:08:35,028 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:08:35.028245
2025-10-22 16:08:35,028 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:08:35,029 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:08:35.028245",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:08:35,052 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:08:35,054 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:08:35,058 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:08:35,058 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:08:35,058 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:08:35,058 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:08:35,058 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:08:35,058 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:08:35,058 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:08:35,059 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:08:47,665 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:08:52,688 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:09:02,795 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:09:02,796 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:09:02.795824
2025-10-22 16:09:02,796 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:09:02,796 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:09:02.795824",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:09:02,824 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:09:02,826 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:09:02,830 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:09:02,830 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:09:02,830 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:09:02,830 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:09:02,830 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:09:02,831 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:09:02,831 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:09:02,832 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:09:02,977 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:09:05,060 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:09:05,060 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:09:05.060548
2025-10-22 16:09:05,061 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:09:05,061 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:09:05.060548",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:09:05,089 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:09:05,091 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:09:05,095 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:09:05,095 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:09:05,095 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:09:05,095 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:09:05,095 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:09:05,095 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:09:05,095 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:09:05,097 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:09:24,080 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:09:29,170 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:09:32,833 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:09:32,833 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:09:32.833107
2025-10-22 16:09:32,833 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:09:32,834 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:09:32.833107",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:09:32,862 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:09:32,864 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:09:32,868 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:09:32,868 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:09:32,868 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:09:32,869 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:09:32,869 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:09:32,869 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:09:32,869 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:09:32,870 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:09:35,097 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:09:35,098 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:09:35.097684
2025-10-22 16:09:35,098 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:09:35,098 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:09:35.097684",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:09:35,126 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:09:35,128 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:09:35,133 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:09:35,133 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:09:35,134 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:09:35,134 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:09:35,134 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:09:35,134 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:09:35,134 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:09:35,135 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:09:39,206 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:10:02,871 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:10:02,871 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:10:02.871194
2025-10-22 16:10:02,871 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:10:02,872 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:10:02.871194",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:10:02,906 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:10:02,908 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:10:02,912 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:10:02,912 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:10:02,912 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:10:02,912 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:10:02,912 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:10:02,913 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:10:02,913 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:10:02,914 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:10:05,136 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:10:05,136 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:10:05.136467
2025-10-22 16:10:05,136 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:10:05,137 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:10:05.136467",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:10:05,163 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:10:05,165 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:10:05,174 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:10:05,174 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:10:05,174 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:10:05,174 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:10:05,174 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:10:05,174 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:10:05,174 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:10:05,176 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:10:32,914 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:10:32,915 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:10:32.914892
2025-10-22 16:10:32,915 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:10:32,915 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:10:32.914892",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:10:32,947 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:10:32,948 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:10:32,953 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:10:32,953 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:10:32,953 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:10:32,953 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:10:32,954 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:10:32,954 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:10:32,954 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:10:32,955 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:10:35,176 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:10:35,176 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:10:35.176566
2025-10-22 16:10:35,176 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:10:35,177 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:10:35.176566",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:10:35,203 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:10:35,204 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:10:35,209 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:10:35,209 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:10:35,209 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:10:35,209 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:10:35,209 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:10:35,209 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:10:35,209 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:10:35,210 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:11:02,956 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:11:02,956 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:11:02.956124
2025-10-22 16:11:02,956 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:11:02,957 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:11:02.956124",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:11:02,985 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:11:02,987 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:11:02,991 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:11:02,991 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:11:02,991 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:11:02,991 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:11:02,992 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:11:02,992 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:11:02,992 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:11:02,993 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:11:05,211 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:11:05,212 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:11:05.211621
2025-10-22 16:11:05,212 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:11:05,212 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:11:05.211621",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:11:05,239 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:11:05,241 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:11:05,245 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:11:05,245 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:11:05,245 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:11:05,246 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:11:05,246 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:11:05,246 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:11:05,246 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:11:05,247 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:11:32,994 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:11:32,994 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:11:32.994284
2025-10-22 16:11:32,994 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:11:32,995 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:11:32.994284",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:11:33,021 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:11:33,022 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:11:33,026 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:11:33,027 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:11:33,027 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:11:33,027 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:11:33,027 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:11:33,027 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:11:33,027 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:11:33,028 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:11:35,248 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:11:35,248 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:11:35.248279
2025-10-22 16:11:35,248 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:11:35,249 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:11:35.248279",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:11:35,278 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:11:35,279 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:11:35,283 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:11:35,283 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:11:35,283 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:11:35,283 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:11:35,284 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:11:35,284 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:11:35,284 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:11:35,285 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:11:59,751 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:12:03,029 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:12:03,029 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:12:03.029316
2025-10-22 16:12:03,029 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:12:03,030 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:12:03.029316",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:12:03,058 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:12:03,059 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:12:03,064 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:12:03,064 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:12:03,064 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:12:03,064 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:12:03,064 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:12:03,064 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:12:03,064 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:12:03,066 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:12:05,286 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:12:05,286 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:12:05.286037
2025-10-22 16:12:05,286 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:12:05,286 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:12:05.286037",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:12:05,328 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:12:05,329 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:12:05,333 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:12:05,334 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:12:05,334 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:12:05,334 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:12:05,334 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:12:05,334 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:12:05,334 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:12:05,335 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:12:13,015 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:12:33,066 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:12:33,067 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:12:33.066644
2025-10-22 16:12:33,067 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:12:33,067 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:12:33.066644",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:12:33,095 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:12:33,097 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:12:33,101 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:12:33,101 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:12:33,101 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:12:33,101 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:12:33,102 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:12:33,102 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:12:33,102 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:12:33,103 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:12:35,336 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:12:35,336 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:12:35.336593
2025-10-22 16:12:35,337 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:12:35,337 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:12:35.336593",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:12:35,366 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:12:35,367 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:12:35,371 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:12:35,371 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:12:35,371 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:12:35,371 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:12:35,371 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:12:35,371 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:12:35,371 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:12:35,372 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:13:03,104 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:13:03,104 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:13:03.104129
2025-10-22 16:13:03,104 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:13:03,104 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:13:03.104129",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:13:03,129 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:13:03,131 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:13:03,135 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:13:03,135 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:13:03,135 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:13:03,135 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:13:03,135 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:13:03,135 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:13:03,136 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:13:03,137 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:13:05,373 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:13:05,374 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:13:05.373676
2025-10-22 16:13:05,374 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:13:05,375 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:13:05.373676",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:13:05,410 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:13:05,413 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:13:05,427 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:13:05,427 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:13:05,427 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:13:05,428 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:13:05,428 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:13:05,428 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:13:05,428 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:13:05,430 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:13:14,675 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:13:19,726 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:13:22,405 - root - INFO - get_fim_events:256 - 🔍 FIM events API called
2025-10-22 16:13:22,406 - root - INFO - get_fim_events:269 - 🔍 Fetching FIM events from 2025-10-21T16:13:22.406126 to 2025-10-22T16:13:22.406159
2025-10-22 16:13:22,406 - server - INFO - get_fim_events:245 - 🔍 Getting FIM events from 2025-10-21T16:13:22.406126 to 2025-10-22T16:13:22.406159
2025-10-22 16:13:22,406 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:13:22,406 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "bool": {
      "must": [
        {
          "range": {
            "@timestamp": {
              "gte": "2025-10-21T16:13:22.406126",
              "lte": "2025-10-22T16:13:22.406159"
            }
          }
        },
        {
          "term": {
            "rule.groups": "syscheck"
          }
        }
      ]
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ]
}
2025-10-22 16:13:22,423 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 164
2025-10-22 16:13:22,424 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:13:22,424 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits']
2025-10-22 16:13:22,424 - server - DEBUG - _make_request:129 - 🔍 Total hits: 0, Actual hits: 0
2025-10-22 16:13:22,424 - server - INFO - get_fim_events:252 - 🔍 FIM Query Results - Total: 0, Returned: 0
2025-10-22 16:13:22,424 - server - WARNING - get_fim_events:264 - 🔍 No FIM hits returned, but total hits > 0
2025-10-22 16:13:22,425 - root - DEBUG - process_fim_events:20 - 🔄 Processing FIM events
2025-10-22 16:13:22,425 - root - WARNING - process_fim_events:34 - ❌ No real FIM data found, generating sample data
2025-10-22 16:13:22,431 - root - INFO - process_fim_events:39 - 📋 Generated 150 sample FIM events
2025-10-22 16:13:22,431 - root - INFO - process_fim_events:44 - ✅ FIM Processing Complete: 150 events, summary: {'total_files': 10, 'total_changes': 150, 'suspicious_changes': 84, 'monitored_agents': 5, 'integrity_score': '4%', 'last_scan': '24m ago', 'total_files_trend': '+1%', 'changes_trend': '+12%', 'suspicious_trend': '+11%', 'agents_trend': '+0%', 'integrity_trend': '+0%'}
2025-10-22 16:13:22,432 - root - INFO - get_fim_events:280 - ✅ Returning FIM data: 150 events
2025-10-22 16:13:26,853 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:13:28,002 - threat_intel - INFO - get_threat_alerts:94 - 🔍 Querying threat alerts from 2025-10-21T16:13:28.002589 to 2025-10-22T16:13:28.002589
2025-10-22 16:13:28,002 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-*/_search
2025-10-22 16:13:28,003 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "bool": {
      "must": [
        {
          "terms": {
            "rule.groups": [
              "misp",
              "misp_alert"
            ]
          }
        },
        {
          "exists": {
            "field": "data.misp"
          }
        }
      ],
      "must_not": [
        {
          "wildcard": {
            "rule.description": "*Error*"
          }
        },
        {
          "wildcard": {
            "rule.description": "*error*"
          }
        }
      ],
      "filter": [
        {
          "range": {
            "timestamp": {
              "gte": "2025-10-21T16:13:28.002589",
              "lte": "2025-10-22T16:13:28.002589"
            }
          }
        }
      ]
    }
  },
  "size": 1000,
  "sort": [
    {
      "timestamp": {
        "order": "desc"
      }
    }
  ],
  "_source": [
    "timestamp",
    "agent",
    "manager",
    "rule",
    "data.misp",
    "location",
    "decoder"
  ]
}
2025-10-22 16:13:28,024 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-*/_search HTTP/1.1" 200 164
2025-10-22 16:13:28,024 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:13:28,025 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits']
2025-10-22 16:13:28,025 - server - DEBUG - _make_request:129 - 🔍 Total hits: 0, Actual hits: 0
2025-10-22 16:13:33,137 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:13:33,138 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:13:33.137824
2025-10-22 16:13:33,138 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:13:33,139 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:13:33.137824",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:13:33,174 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:13:33,175 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:13:33,179 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:13:33,179 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:13:33,179 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:13:33,179 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:13:33,180 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:13:33,180 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:13:33,180 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:13:33,181 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:13:35,431 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:13:35,431 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:13:35.431583
2025-10-22 16:13:35,432 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:13:35,432 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:13:35.431583",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:13:35,470 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:13:35,472 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:13:35,476 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:13:35,476 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:13:35,476 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:13:35,476 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:13:35,476 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:13:35,476 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:13:35,476 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:13:35,478 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:13:38,827 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:14:03,182 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:14:03,182 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:14:03.182156
2025-10-22 16:14:03,182 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:14:03,183 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:14:03.182156",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:14:03,211 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:14:03,213 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:14:03,217 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:14:03,217 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:14:03,217 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:14:03,217 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:14:03,217 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:14:03,218 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:14:03,218 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:14:03,219 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:14:05,478 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:14:05,479 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:14:05.478727
2025-10-22 16:14:05,479 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:14:05,479 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:14:05.478727",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:14:05,504 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:14:05,506 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:14:05,512 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:14:05,512 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:14:05,512 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:14:05,512 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:14:05,512 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:14:05,512 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:14:05,513 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:14:05,514 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:14:33,220 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:14:33,220 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:14:33.220074
2025-10-22 16:14:33,220 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:14:33,220 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:14:33.220074",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:14:33,249 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:14:33,250 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:14:33,256 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:14:33,257 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:14:33,257 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:14:33,257 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:14:33,257 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:14:33,257 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:14:33,258 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:14:33,260 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:14:35,515 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:14:35,515 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:14:35.515062
2025-10-22 16:14:35,515 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:14:35,516 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:14:35.515062",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:14:35,537 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:14:35,539 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:14:35,543 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:14:35,543 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:14:35,543 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:14:35,543 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:14:35,544 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:14:35,544 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:14:35,544 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:14:35,545 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:14:58,025 - root - ERROR - get_dashboard_data:540 - ❌ Dashboard data error: name 'wwazuh_client' is not defined
2025-10-22 16:15:04,534 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 16:15:04,534 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 16:15:04,547 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:15:04,548 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:15:04.547786
2025-10-22 16:15:04,548 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:15:04,548 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:15:04.547786",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:15:04,548 - root - INFO - <module>:646 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 16:15:04,551 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:15:04,601 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:15:04,604 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:15:04,608 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:15:04,609 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:15:04,609 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:15:04,609 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:15:04,609 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:15:04,609 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:15:04,609 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:15:04,610 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:15:07,905 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:15:07,905 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:15:07.905074
2025-10-22 16:15:07,905 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:15:07,905 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:15:07.905074",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:15:07,935 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:15:07,937 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:15:07,941 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:15:07,942 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:15:07,942 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:15:07,942 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:15:07,942 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:15:07,942 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:15:07,942 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:15:07,944 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:15:16,009 - root - INFO - get_fim_events:256 - 🔍 FIM events API called
2025-10-22 16:15:16,009 - root - INFO - get_fim_events:269 - 🔍 Fetching FIM events from 2025-10-21T16:15:16.009588 to 2025-10-22T16:15:16.009619
2025-10-22 16:15:16,061 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 16:15:16,061 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 16:15:16,074 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:15:16,075 - server - INFO - get_fim_events:245 - 🔍 Getting FIM events from 2025-10-21T16:15:16.009588 to 2025-10-22T16:15:16.009619
2025-10-22 16:15:16,075 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:15:16.074782
2025-10-22 16:15:16,075 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:15:16,076 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:15:16,076 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "bool": {
      "must": [
        {
          "range": {
            "@timestamp": {
              "gte": "2025-10-21T16:15:16.009588",
              "lte": "2025-10-22T16:15:16.009619"
            }
          }
        },
        {
          "term": {
            "rule.groups": "syscheck"
          }
        }
      ]
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ]
}
2025-10-22 16:15:16,077 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:15:16.074782",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:15:16,079 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:15:16,081 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (2): 127.0.0.1:9200
2025-10-22 16:15:16,110 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 164
2025-10-22 16:15:16,111 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:15:16,111 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits']
2025-10-22 16:15:16,111 - server - DEBUG - _make_request:129 - 🔍 Total hits: 0, Actual hits: 0
2025-10-22 16:15:16,111 - server - INFO - get_fim_events:252 - 🔍 FIM Query Results - Total: 0, Returned: 0
2025-10-22 16:15:16,111 - server - WARNING - get_fim_events:264 - 🔍 No FIM hits returned, but total hits > 0
2025-10-22 16:15:16,111 - root - DEBUG - process_fim_events:20 - 🔄 Processing FIM events
2025-10-22 16:15:16,111 - root - WARNING - process_fim_events:34 - ❌ No real FIM data found, generating sample data
2025-10-22 16:15:16,118 - root - INFO - process_fim_events:39 - 📋 Generated 150 sample FIM events
2025-10-22 16:15:16,118 - root - INFO - process_fim_events:44 - ✅ FIM Processing Complete: 150 events, summary: {'total_files': 10, 'total_changes': 150, 'suspicious_changes': 68, 'monitored_agents': 5, 'integrity_score': '44%', 'last_scan': '1m ago', 'total_files_trend': '+3%', 'changes_trend': '+8%', 'suspicious_trend': '+9%', 'agents_trend': '+0%', 'integrity_trend': '+0%'}
2025-10-22 16:15:16,118 - root - INFO - get_fim_events:280 - ✅ Returning FIM data: 150 events
2025-10-22 16:15:16,122 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:15:16,124 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:15:16,130 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:15:16,130 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:15:16,130 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:15:16,130 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:15:16,130 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:15:16,131 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:15:16,131 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:15:16,132 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:15:22,643 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:15:22,644 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:15:22.643860
2025-10-22 16:15:22,644 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:15:22,644 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:15:22.643860",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:15:22,673 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:15:22,674 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:15:22,678 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:15:22,678 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:15:22,679 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:15:22,679 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:15:22,679 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:15:22,679 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:15:22,679 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:15:22,680 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:15:22,683 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:15:22,710 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /_plugins/_anomaly_detection/detectors/_search HTTP/1.1" 200 6310
2025-10-22 16:15:22,736 - uba - INFO - get_anomaly_results:47 - 🔍 Fetching UBA anomalies with grade > 0.1
2025-10-22 16:15:22,745 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "POST /_plugins/_anomaly_detection/detectors/results/_search HTTP/1.1" 200 7096
2025-10-22 16:15:22,746 - uba - INFO - get_anomaly_results:53 - 📊 Found 6 UBA anomalies
2025-10-22 16:15:22,746 - root - DEBUG - process_anomalies_for_dashboard:82 - 🔄 Processing UBA anomalies for dashboard
2025-10-22 16:15:22,746 - root - INFO - process_anomalies_for_dashboard:91 - 🔄 Processing 6 UBA anomalies
2025-10-22 16:15:22,747 - root - INFO - process_anomalies_for_dashboard:132 - ✅ Processed 6 UBA anomalies
2025-10-22 16:15:34,611 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:15:34,611 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:15:34.611469
2025-10-22 16:15:34,611 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:15:34,612 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:15:34.611469",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:15:34,639 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:15:34,640 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:15:34,644 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:15:34,644 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:15:34,644 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:15:34,644 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:15:34,644 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:15:34,645 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:15:34,645 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:15:34,646 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:15:46,133 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:15:46,133 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:15:46.132986
2025-10-22 16:15:46,133 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:15:46,133 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:15:46.132986",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:15:46,163 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:15:46,164 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:15:46,168 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:15:46,169 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:15:46,169 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:15:46,169 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:15:46,169 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:15:46,169 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:15:46,169 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:15:46,170 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:15:52,664 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:15:52,665 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:15:52.664633
2025-10-22 16:15:52,665 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:15:52,665 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:15:52.664633",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:15:52,692 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:15:52,694 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:15:52,698 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:15:52,698 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:15:52,698 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:15:52,698 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:15:52,699 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:15:52,699 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:15:52,699 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:15:52,700 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:15:57,621 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:15:57,622 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:15:57.621898
2025-10-22 16:15:57,622 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:15:57,622 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:15:57.621898",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:15:57,651 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:15:57,653 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:15:57,656 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:15:57,657 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:15:57,657 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:15:57,657 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:15:57,657 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:15:57,657 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:15:57,657 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:15:57,658 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:16:04,647 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:16:04,647 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:16:04.647062
2025-10-22 16:16:04,647 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:16:04,647 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:16:04.647062",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:16:04,674 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:16:04,676 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:16:04,680 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:16:04,681 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:16:04,681 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:16:04,681 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:16:04,681 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:16:04,681 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:16:04,681 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:16:04,682 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:16:08,263 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-21T16:16:08.262941 to 2025-10-22T16:16:08.262941
2025-10-22 16:16:08,263 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:16:08,263 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-21T16:16:08.262941",
        "lte": "2025-10-22T16:16:08.262941",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:16:08,290 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:16:08,292 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:16:08,296 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:16:08,296 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:16:08,296 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:16:08,296 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:16:08,296 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:16:08,297 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:16:08,297 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:16:08,298 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:16:10,004 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-21T16:16:10.004898 to 2025-10-22T16:16:10.004898
2025-10-22 16:16:10,005 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:16:10,005 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-21T16:16:10.004898",
        "lte": "2025-10-22T16:16:10.004898",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:16:10,046 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:16:10,048 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:16:10,051 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:16:10,051 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:16:10,052 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:16:10,052 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:16:10,052 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:16:10,052 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:16:10,052 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:16:10,053 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:16:11,878 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-21T16:16:11.878817 to 2025-10-22T16:16:11.878817
2025-10-22 16:16:11,879 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:16:11,879 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-21T16:16:11.878817",
        "lte": "2025-10-22T16:16:11.878817",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:16:11,909 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:16:11,911 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:16:11,915 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:16:11,915 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:16:11,915 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:16:11,915 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:16:11,915 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:16:11,915 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:16:11,915 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:16:11,917 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:16:16,171 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:16:16,171 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:16:16.171508
2025-10-22 16:16:16,171 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:16:16,172 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:16:16.171508",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:16:16,195 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:16:16,197 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:16:16,200 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:16:16,200 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:16:16,201 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:16:16,201 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:16:16,201 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:16:16,201 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:16:16,201 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:16:16,202 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:16:34,683 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:16:34,683 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:16:34.683314
2025-10-22 16:16:34,683 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:16:34,684 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:16:34.683314",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:16:34,711 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:16:34,712 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:16:34,722 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:16:34,723 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:16:34,723 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:16:34,723 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:16:34,724 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:16:34,724 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:16:34,724 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:16:34,726 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:16:46,203 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:16:46,203 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:16:46.203208
2025-10-22 16:16:46,203 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:16:46,204 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:16:46.203208",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:16:46,238 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:16:46,240 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:16:46,244 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:16:46,244 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:16:46,244 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:16:46,244 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:16:46,244 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:16:46,244 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:16:46,245 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:16:46,246 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:17:04,726 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:17:04,727 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:17:04.726658
2025-10-22 16:17:04,727 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:17:04,727 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:17:04.726658",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:17:04,754 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:17:04,756 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:17:04,760 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:17:04,760 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:17:04,760 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:17:04,761 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:17:04,761 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:17:04,761 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:17:04,761 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:17:04,762 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:17:16,246 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:17:16,247 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:17:16.246835
2025-10-22 16:17:16,247 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:17:16,247 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:17:16.246835",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:17:16,275 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:17:16,277 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:17:16,281 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:17:16,281 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:17:16,281 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:17:16,281 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:17:16,281 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:17:16,282 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:17:16,282 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:17:16,283 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:17:34,763 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:17:34,763 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:17:34.763240
2025-10-22 16:17:34,763 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:17:34,764 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:17:34.763240",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:17:34,787 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:17:34,788 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:17:34,792 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:17:34,792 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:17:34,792 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:17:34,792 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:17:34,792 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:17:34,792 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:17:34,792 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:17:34,794 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:17:46,284 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:17:46,284 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:17:46.284221
2025-10-22 16:17:46,284 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:17:46,285 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:17:46.284221",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:17:46,309 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:17:46,311 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:17:46,315 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:17:46,315 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:17:46,315 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:17:46,315 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:17:46,315 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:17:46,315 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:17:46,315 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:17:46,317 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:17:55,062 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:17:55,062 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:17:55.062611
2025-10-22 16:17:55,063 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:17:55,063 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:17:55.062611",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:17:55,087 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:17:55,089 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:17:55,094 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:17:55,094 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:17:55,094 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:17:55,094 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:17:55,094 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:17:55,094 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:17:55,094 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:17:55,095 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:18:04,794 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:18:04,795 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:18:04.794622
2025-10-22 16:18:04,795 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:18:04,795 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:18:04.794622",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:18:04,822 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:18:04,823 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:18:04,828 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:18:04,828 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:18:04,828 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:18:04,828 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:18:04,828 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:18:04,828 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:18:04,828 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:18:04,830 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:18:16,317 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:18:16,318 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:18:16.317695
2025-10-22 16:18:16,318 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:18:16,318 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:18:16.317695",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:18:16,346 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:18:16,347 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:18:16,351 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:18:16,351 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:18:16,351 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:18:16,352 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:18:16,352 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:18:16,352 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:18:16,352 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:18:16,353 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:18:34,830 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:18:34,831 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:18:34.830875
2025-10-22 16:18:34,831 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:18:34,831 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:18:34.830875",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:18:34,858 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:18:34,860 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:18:34,864 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:18:34,864 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:18:34,864 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:18:34,864 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:18:34,865 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:18:34,865 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:18:34,865 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:18:34,866 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:18:46,354 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:18:46,354 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:18:46.354215
2025-10-22 16:18:46,354 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:18:46,355 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:18:46.354215",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:18:46,384 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:18:46,386 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:18:46,390 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:18:46,390 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:18:46,390 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:18:46,390 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:18:46,390 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:18:46,392 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:18:46,392 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:18:46,393 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:19:04,867 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:19:04,867 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:19:04.867114
2025-10-22 16:19:04,867 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:19:04,867 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:19:04.867114",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:19:04,897 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:19:04,898 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:19:04,902 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:19:04,902 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:19:04,902 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:19:04,902 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:19:04,902 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:19:04,902 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:19:04,903 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:19:04,904 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:19:16,394 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:19:16,394 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:19:16.394461
2025-10-22 16:19:16,394 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:19:16,395 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:19:16.394461",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:19:16,419 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 121865
2025-10-22 16:19:16,420 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:19:16,428 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:19:16,429 - server - DEBUG - _make_request:129 - 🔍 Total hits: 76, Actual hits: 76
2025-10-22 16:19:16,429 - server - DEBUG - _make_request:134 - 🔍 First hit ID: G3pQC5oBnysS8cfebnou
2025-10-22 16:19:16,429 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T09:46:41.125Z
2025-10-22 16:19:16,429 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['pam', 'syslog']
2025-10-22 16:19:16,429 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:19:16,429 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 76 total alerts, 76 returned
2025-10-22 16:19:16,430 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 76 alerts for dashboard
2025-10-22 16:19:25,044 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:19:25,044 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:19:25.044584
2025-10-22 16:19:25,045 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:19:25,045 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:19:25.044584",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:19:25,072 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:19:25,074 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:19:25,078 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:19:25,078 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:19:25,078 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:19:25,078 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:19:25,078 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:19:25,079 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:19:25,079 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:19:25,080 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:19:34,904 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:19:34,905 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:19:34.904753
2025-10-22 16:19:34,905 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:19:34,905 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:19:34.904753",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:19:34,941 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:19:34,943 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:19:34,947 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:19:34,947 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:19:34,947 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:19:34,947 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:19:34,947 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:19:34,947 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:19:34,948 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:19:34,949 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:19:46,431 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:19:46,431 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:19:46.431495
2025-10-22 16:19:46,432 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:19:46,432 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:19:46.431495",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:19:46,459 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:19:46,461 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:19:46,465 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:19:46,466 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:19:46,466 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:19:46,466 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:19:46,467 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:19:46,467 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:19:46,467 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:19:46,469 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:20:04,949 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:20:04,950 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:20:04.949826
2025-10-22 16:20:04,950 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:20:04,950 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:20:04.949826",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:20:04,976 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:20:04,978 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:20:04,982 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:20:04,982 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:20:04,983 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:20:04,983 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:20:04,983 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:20:04,983 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:20:04,983 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:20:04,984 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:20:16,469 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:20:16,470 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:20:16.469857
2025-10-22 16:20:16,470 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:20:16,470 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:20:16.469857",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:20:16,496 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:20:16,497 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:20:16,501 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:20:16,502 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:20:16,502 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:20:16,502 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:20:16,502 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:20:16,502 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:20:16,502 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:20:16,503 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:20:34,985 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:20:34,985 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:20:34.985452
2025-10-22 16:20:34,985 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:20:34,986 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:20:34.985452",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:20:35,009 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:20:35,011 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:20:35,014 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:20:35,015 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:20:35,015 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:20:35,015 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:20:35,015 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:20:35,015 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:20:35,015 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:20:35,016 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:20:46,504 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:20:46,504 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:20:46.504488
2025-10-22 16:20:46,505 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:20:46,505 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:20:46.504488",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:20:46,529 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:20:46,530 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:20:46,535 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:20:46,535 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:20:46,535 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:20:46,535 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:20:46,535 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:20:46,535 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:20:46,536 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:20:46,537 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:20:55,151 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:20:55,151 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:20:55.151511
2025-10-22 16:20:55,152 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:20:55,152 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:20:55.151511",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:20:55,179 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:20:55,180 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:20:55,184 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:20:55,184 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:20:55,185 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:20:55,185 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:20:55,185 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:20:55,185 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:20:55,185 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:20:55,186 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:21:05,017 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:21:05,017 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:21:05.017575
2025-10-22 16:21:05,018 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:21:05,018 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:21:05.017575",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:21:05,044 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:21:05,046 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:21:05,050 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:21:05,050 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:21:05,050 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:21:05,050 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:21:05,050 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:21:05,051 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:21:05,051 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:21:05,052 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:21:16,538 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:21:16,538 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:21:16.538108
2025-10-22 16:21:16,538 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:21:16,539 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:21:16.538108",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:21:16,573 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:21:16,574 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:21:16,579 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:21:16,579 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:21:16,579 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:21:16,579 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:21:16,579 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:21:16,579 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:21:16,580 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:21:16,581 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:21:35,053 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:21:35,053 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:21:35.053329
2025-10-22 16:21:35,053 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:21:35,054 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:21:35.053329",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:21:35,080 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:21:35,081 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:21:35,086 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:21:35,086 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:21:35,086 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:21:35,086 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:21:35,086 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:21:35,086 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:21:35,086 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:21:35,088 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:21:46,581 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:21:46,582 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:21:46.581805
2025-10-22 16:21:46,582 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:21:46,582 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:21:46.581805",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:21:46,611 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:21:46,612 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:21:46,622 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:21:46,622 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:21:46,623 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:21:46,623 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:21:46,623 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:21:46,623 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:21:46,623 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:21:46,624 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:22:05,089 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:22:05,089 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:22:05.088984
2025-10-22 16:22:05,089 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:22:05,090 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:22:05.088984",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:22:05,117 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:22:05,120 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:22:05,127 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:22:05,127 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:22:05,127 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:22:05,127 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:22:05,127 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:22:05,128 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:22:05,128 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:22:05,129 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:22:16,625 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:22:16,625 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:22:16.625333
2025-10-22 16:22:16,626 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:22:16,626 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:22:16.625333",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:22:16,651 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:22:16,653 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:22:16,658 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:22:16,658 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:22:16,658 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:22:16,658 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:22:16,658 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:22:16,658 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:22:16,658 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:22:16,659 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:22:34,552 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:22:34,552 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:22:34.552562
2025-10-22 16:22:34,553 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:22:34,553 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:22:34.552562",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:22:34,578 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:22:34,579 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:22:34,583 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:22:34,584 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:22:34,584 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:22:34,584 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:22:34,584 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:22:34,584 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:22:34,584 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:22:34,585 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:22:35,130 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:22:35,130 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:22:35.129959
2025-10-22 16:22:35,130 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:22:35,130 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:22:35.129959",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:22:35,166 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:22:35,168 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:22:35,172 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:22:35,172 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:22:35,172 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:22:35,172 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:22:35,172 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:22:35,172 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:22:35,172 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:22:35,174 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:22:46,660 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:22:46,661 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:22:46.660589
2025-10-22 16:22:46,661 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:22:46,661 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:22:46.660589",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:22:46,691 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:22:46,692 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:22:46,696 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:22:46,696 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:22:46,697 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:22:46,697 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:22:46,697 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:22:46,697 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:22:46,697 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:22:46,698 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:23:05,174 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:23:05,174 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:23:05.174582
2025-10-22 16:23:05,175 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:23:05,175 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:23:05.174582",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:23:05,196 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:23:05,198 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:23:05,202 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:23:05,202 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:23:05,202 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:23:05,202 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:23:05,202 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:23:05,202 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:23:05,202 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:23:05,204 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:23:16,699 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:23:16,699 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:23:16.699550
2025-10-22 16:23:16,700 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:23:16,700 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:23:16.699550",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:23:16,735 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:23:16,736 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:23:16,740 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:23:16,741 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:23:16,741 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:23:16,741 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:23:16,741 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:23:16,741 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:23:16,741 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:23:16,742 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:23:35,204 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:23:35,205 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:23:35.204630
2025-10-22 16:23:35,205 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:23:35,205 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:23:35.204630",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:23:35,238 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:23:35,240 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:23:35,244 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:23:35,244 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:23:35,244 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:23:35,244 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:23:35,244 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:23:35,245 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:23:35,245 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:23:35,246 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:23:46,743 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:23:46,743 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:23:46.743464
2025-10-22 16:23:46,744 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:23:46,744 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:23:46.743464",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:23:46,771 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:23:46,773 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:23:46,777 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:23:46,777 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:23:46,777 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:23:46,777 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:23:46,777 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:23:46,777 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:23:46,778 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:23:46,779 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:24:04,559 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:24:04,559 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:24:04.559183
2025-10-22 16:24:04,559 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:24:04,559 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:24:04.559183",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:24:04,587 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:24:04,589 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:24:04,593 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:24:04,593 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:24:04,593 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:24:04,593 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:24:04,593 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:24:04,593 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:24:04,593 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:24:04,595 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:24:05,247 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:24:05,247 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:24:05.247003
2025-10-22 16:24:05,247 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:24:05,247 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:24:05.247003",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:24:05,271 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:24:05,272 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:24:05,276 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:24:05,276 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:24:05,277 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:24:05,277 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:24:05,277 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:24:05,277 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:24:05,277 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:24:05,278 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:24:16,780 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:24:16,780 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:24:16.780006
2025-10-22 16:24:16,780 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:24:16,780 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:24:16.780006",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:24:16,806 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:24:16,809 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:24:16,819 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:24:16,819 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:24:16,819 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:24:16,819 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:24:16,819 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:24:16,819 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:24:16,820 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:24:16,822 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:24:35,279 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:24:35,279 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:24:35.279268
2025-10-22 16:24:35,279 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:24:35,280 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:24:35.279268",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:24:35,307 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:24:35,309 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:24:35,313 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:24:35,313 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:24:35,313 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:24:35,313 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:24:35,314 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:24:35,314 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:24:35,314 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:24:35,315 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:24:46,822 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:24:46,823 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:24:46.822826
2025-10-22 16:24:46,823 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:24:46,823 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:24:46.822826",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:24:46,850 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:24:46,852 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:24:46,856 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:24:46,856 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:24:46,856 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:24:46,856 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:24:46,857 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:24:46,857 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:24:46,857 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:24:46,858 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:25:05,316 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:25:05,316 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:25:05.316565
2025-10-22 16:25:05,317 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:25:05,317 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:25:05.316565",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:25:05,341 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:25:05,342 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:25:05,346 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:25:05,346 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:25:05,346 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:25:05,346 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:25:05,346 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:25:05,347 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:25:05,347 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:25:05,348 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:25:16,859 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:25:16,859 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:25:16.859147
2025-10-22 16:25:16,859 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:25:16,860 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:25:16.859147",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:25:16,887 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:25:16,890 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:25:16,894 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:25:16,895 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:25:16,895 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:25:16,895 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:25:16,895 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:25:16,895 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:25:16,895 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:25:16,896 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:25:34,557 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:25:34,558 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:25:34.557899
2025-10-22 16:25:34,558 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:25:34,558 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:25:34.557899",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:25:34,583 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:25:34,585 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:25:34,590 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:25:34,591 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:25:34,591 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:25:34,591 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:25:34,591 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:25:34,591 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:25:34,591 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:25:34,593 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:25:35,348 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:25:35,349 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:25:35.348867
2025-10-22 16:25:35,349 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:25:35,349 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:25:35.348867",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:25:35,390 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:25:35,392 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:25:35,397 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:25:35,397 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:25:35,397 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:25:35,397 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:25:35,397 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:25:35,398 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:25:35,398 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:25:35,399 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:25:46,897 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:25:46,898 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:25:46.897471
2025-10-22 16:25:46,898 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:25:46,899 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:25:46.897471",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:25:46,923 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:25:46,924 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:25:46,928 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:25:46,928 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:25:46,929 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:25:46,929 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:25:46,929 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:25:46,929 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:25:46,929 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:25:46,930 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:26:05,400 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:26:05,400 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:26:05.399964
2025-10-22 16:26:05,400 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:26:05,400 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:26:05.399964",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:26:05,429 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:26:05,431 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:26:05,435 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:26:05,435 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:26:05,435 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:26:05,435 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:26:05,435 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:26:05,435 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:26:05,436 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:26:05,437 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:26:16,931 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:26:16,931 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:26:16.931240
2025-10-22 16:26:16,931 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:26:16,932 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:26:16.931240",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:26:16,958 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:26:16,960 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:26:16,964 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:26:16,964 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:26:16,964 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:26:16,964 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:26:16,964 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:26:16,965 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:26:16,965 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:26:16,966 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:26:35,437 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:26:35,438 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:26:35.437816
2025-10-22 16:26:35,438 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:26:35,438 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:26:35.437816",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:26:35,465 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:26:35,467 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:26:35,471 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:26:35,472 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:26:35,472 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:26:35,472 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:26:35,472 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:26:35,472 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:26:35,472 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:26:35,473 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:26:46,967 - server - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:26:46,967 - server - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:26:46.967147
2025-10-22 16:26:46,967 - server - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:26:46,968 - server - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:26:46.967147",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:26:46,995 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:26:46,997 - server - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:26:47,001 - server - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:26:47,001 - server - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:26:47,001 - server - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:26:47,001 - server - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:26:47,001 - server - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:26:47,001 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:26:47,002 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:26:47,003 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:27:04,562 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:27:04,563 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:27:04.562866
2025-10-22 16:27:04,563 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:27:04,563 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:27:04.562866",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:27:04,586 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:27:04,588 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:27:04,597 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:27:04,597 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:27:04,597 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:27:04,597 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:27:04,597 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:27:04,597 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:27:04,598 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:27:04,599 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:27:05,474 - __main__ - INFO - get_todays_alerts:181 - 📊 Getting today's alerts
2025-10-22 16:27:05,474 - __main__ - INFO - get_alerts_by_time_range:170 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:27:05.474612
2025-10-22 16:27:05,475 - __main__ - DEBUG - _make_request:116 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:27:05,475 - __main__ - DEBUG - _make_request:117 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:27:05.474612",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:27:05,501 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:27:05,502 - __main__ - DEBUG - _make_request:120 - 🔍 Response status: 200
2025-10-22 16:27:05,506 - __main__ - DEBUG - _make_request:125 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:27:05,506 - __main__ - DEBUG - _make_request:129 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:27:05,506 - __main__ - DEBUG - _make_request:134 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:27:05,506 - __main__ - DEBUG - _make_request:135 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:27:05,507 - __main__ - DEBUG - _make_request:136 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:27:05,507 - root - DEBUG - process_alerts_for_dashboard:274 - 🔄 Processing alerts for dashboard
2025-10-22 16:27:05,507 - root - INFO - process_alerts_for_dashboard:288 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:27:05,508 - root - INFO - process_alerts_for_dashboard:344 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:35:46,110 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 16:35:46,110 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 16:35:46,122 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:35:46,122 - root - INFO - <module>:636 - 🚀 Starting Professional SOC Dashboard with Enhanced Debug Logging...
2025-10-22 16:35:46,122 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:35:46.122129
2025-10-22 16:35:46,123 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:35:46,123 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:35:46.122129",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:35:46,126 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:35:46,173 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:35:46,175 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:35:46,180 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:35:46,180 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:35:46,180 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:35:46,180 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:35:46,181 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:35:46,181 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:35:46,181 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:35:46,182 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:35:50,770 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:35:50,770 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:35:50.770227
2025-10-22 16:35:50,770 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:35:50,771 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:35:50.770227",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:35:50,796 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:35:50,798 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:35:50,802 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:35:50,803 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:35:50,803 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:35:50,803 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:35:50,803 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:35:50,803 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:35:50,803 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:35:50,804 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:35:53,725 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:35:54,578 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /_cluster/health HTTP/1.1" 401 12
2025-10-22 16:35:54,654 - root - INFO - get_fim_events:257 - 🔍 FIM events API called
2025-10-22 16:35:54,655 - root - INFO - get_fim_events:270 - 🔍 Fetching FIM events from 2025-10-21T16:35:54.655237 to 2025-10-22T16:35:54.655268
2025-10-22 16:35:54,702 - threat_intel - INFO - __init__:41 - ✅ Threat Intelligence client initialized
2025-10-22 16:35:54,702 - threat_intel - INFO - init_threat_intel_client:661 - ✅ Threat Intelligence client initialized
2025-10-22 16:35:54,714 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:35:54,715 - server - INFO - get_fim_events:235 - 🔍 Getting FIM events from 2025-10-21T16:35:54.655237 to 2025-10-22T16:35:54.655268
2025-10-22 16:35:54,715 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:35:54.714700
2025-10-22 16:35:54,715 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:35:54,715 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:35:54,716 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "bool": {
      "must": [
        {
          "range": {
            "@timestamp": {
              "gte": "2025-10-21T16:35:54.655237",
              "lte": "2025-10-22T16:35:54.655268"
            }
          }
        },
        {
          "term": {
            "rule.groups": "syscheck"
          }
        }
      ]
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ]
}
2025-10-22 16:35:54,716 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:35:54.714700",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:35:54,718 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:35:54,719 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (2): 127.0.0.1:9200
2025-10-22 16:35:54,748 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 164
2025-10-22 16:35:54,748 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:35:54,748 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits']
2025-10-22 16:35:54,749 - server - DEBUG - _make_request:119 - 🔍 Total hits: 0, Actual hits: 0
2025-10-22 16:35:54,749 - server - INFO - get_fim_events:242 - 🔍 FIM Query Results - Total: 0, Returned: 0
2025-10-22 16:35:54,749 - server - WARNING - get_fim_events:254 - 🔍 No FIM hits returned, but total hits > 0
2025-10-22 16:35:54,749 - root - DEBUG - process_fim_events:21 - 🔄 Processing FIM events
2025-10-22 16:35:54,749 - root - WARNING - process_fim_events:35 - ❌ No real FIM data found, generating sample data
2025-10-22 16:35:54,755 - root - INFO - process_fim_events:40 - 📋 Generated 150 sample FIM events
2025-10-22 16:35:54,756 - root - INFO - process_fim_events:45 - ✅ FIM Processing Complete: 150 events, summary: {'total_files': 10, 'total_changes': 150, 'suspicious_changes': 74, 'monitored_agents': 5, 'integrity_score': '22%', 'last_scan': '12m ago', 'total_files_trend': '+2%', 'changes_trend': '+14%', 'suspicious_trend': '+6%', 'agents_trend': '+0%', 'integrity_trend': '+2%'}
2025-10-22 16:35:54,756 - root - INFO - get_fim_events:281 - ✅ Returning FIM data: 150 events
2025-10-22 16:35:54,759 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:35:54,761 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:35:54,764 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:35:54,764 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:35:54,764 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:35:54,764 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:35:54,765 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:35:54,765 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:35:54,765 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:35:54,766 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:35:55,510 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:35:55,510 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:35:55.510583
2025-10-22 16:35:55,511 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:35:55,511 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:35:55.510583",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:35:55,532 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:35:55,537 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:35:55,539 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:35:55,543 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:35:55,543 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:35:55,543 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:35:55,543 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:35:55,544 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:35:55,544 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:35:55,544 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:35:55,545 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:35:55,567 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /_plugins/_anomaly_detection/detectors/_search HTTP/1.1" 200 6310
2025-10-22 16:35:55,604 - uba - INFO - get_anomaly_results:48 - 🔍 Fetching UBA anomalies with grade > 0.1
2025-10-22 16:35:55,612 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "POST /_plugins/_anomaly_detection/detectors/results/_search HTTP/1.1" 200 7096
2025-10-22 16:35:55,613 - uba - INFO - get_anomaly_results:54 - 📊 Found 6 UBA anomalies
2025-10-22 16:35:55,613 - root - DEBUG - process_anomalies_for_dashboard:83 - 🔄 Processing UBA anomalies for dashboard
2025-10-22 16:35:55,613 - root - INFO - process_anomalies_for_dashboard:92 - 🔄 Processing 6 UBA anomalies
2025-10-22 16:35:55,614 - root - INFO - process_anomalies_for_dashboard:133 - ✅ Processed 6 UBA anomalies
2025-10-22 16:35:56,206 - threat_intel - INFO - get_threat_alerts:94 - 🔍 Querying threat alerts from 2025-10-21T16:35:56.206074 to 2025-10-22T16:35:56.206074
2025-10-22 16:35:56,206 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-*/_search
2025-10-22 16:35:56,206 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "bool": {
      "must": [
        {
          "terms": {
            "rule.groups": [
              "misp",
              "misp_alert"
            ]
          }
        },
        {
          "exists": {
            "field": "data.misp"
          }
        }
      ],
      "must_not": [
        {
          "wildcard": {
            "rule.description": "*Error*"
          }
        },
        {
          "wildcard": {
            "rule.description": "*error*"
          }
        }
      ],
      "filter": [
        {
          "range": {
            "timestamp": {
              "gte": "2025-10-21T16:35:56.206074",
              "lte": "2025-10-22T16:35:56.206074"
            }
          }
        }
      ]
    }
  },
  "size": 1000,
  "sort": [
    {
      "timestamp": {
        "order": "desc"
      }
    }
  ],
  "_source": [
    "timestamp",
    "agent",
    "manager",
    "rule",
    "data.misp",
    "location",
    "decoder"
  ]
}
2025-10-22 16:35:56,225 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-*/_search HTTP/1.1" 200 164
2025-10-22 16:35:56,226 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:35:56,226 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits']
2025-10-22 16:35:56,226 - server - DEBUG - _make_request:119 - 🔍 Total hits: 0, Actual hits: 0
2025-10-22 16:35:56,869 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:35:56,904 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "POST /wazuh-states-vulnerabilities-*/_search HTTP/1.1" 200 845842
2025-10-22 16:35:57,008 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 127.0.0.1:9200
2025-10-22 16:35:57,036 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "POST /wazuh-states-vulnerabilities-*/_search HTTP/1.1" 200 53532
2025-10-22 16:35:57,861 - root - INFO - get_case_summary:291 - 📊 Fetching case management summary from IRIS
2025-10-22 16:35:57,861 - case_management - DEBUG - _make_request:42 - 🔍 Making GET request to: https://10.10.192.205:4433/manage/cases/list
2025-10-22 16:35:57,863 - urllib3.connectionpool - DEBUG - _new_conn:1049 - Starting new HTTPS connection (1): 10.10.192.205:4433
2025-10-22 16:35:57,917 - urllib3.connectionpool - DEBUG - _make_request:544 - https://10.10.192.205:4433 "GET /manage/cases/list?page=1&per_page=100 HTTP/1.1" 200 1935
2025-10-22 16:35:57,918 - case_management - DEBUG - _make_request:66 - 🔍 Response status: 200
2025-10-22 16:35:57,918 - root - INFO - get_case_summary:296 - 🔍 Cases response type: <class 'dict'>
2025-10-22 16:35:57,918 - root - INFO - process_cases_summary:174 - 📊 Processing 4 cases from IRIS
2025-10-22 16:35:57,958 - root - INFO - get_cases:316 - 📊 Fetching cases from IRIS
2025-10-22 16:35:57,958 - case_management - DEBUG - _make_request:42 - 🔍 Making GET request to: https://10.10.192.205:4433/manage/cases/list
2025-10-22 16:35:57,990 - urllib3.connectionpool - DEBUG - _make_request:544 - https://10.10.192.205:4433 "GET /manage/cases/list?page=1&per_page=25 HTTP/1.1" 200 1935
2025-10-22 16:35:57,991 - case_management - DEBUG - _make_request:66 - 🔍 Response status: 200
2025-10-22 16:35:57,991 - root - INFO - get_cases:326 - 📋 Extracted 4 cases from IRIS response
2025-10-22 16:35:58,019 - case_management - DEBUG - _make_request:42 - 🔍 Making GET request to: https://10.10.192.205:4433/manage/cases/list
2025-10-22 16:35:58,052 - urllib3.connectionpool - DEBUG - _make_request:544 - https://10.10.192.205:4433 "GET /manage/cases/list?page=1&per_page=1 HTTP/1.1" 200 1935
2025-10-22 16:35:58,052 - case_management - DEBUG - _make_request:66 - 🔍 Response status: 200
2025-10-22 16:35:59,451 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:35:59,451 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:35:59.451482
2025-10-22 16:35:59,451 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:35:59,452 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:35:59.451482",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:35:59,473 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:35:59,475 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:35:59,477 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:35:59,477 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:35:59,477 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:35:59,477 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:35:59,477 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:35:59,477 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:35:59,477 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:35:59,478 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:36:16,183 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:36:16,183 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:36:16.183188
2025-10-22 16:36:16,183 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:36:16,184 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:36:16.183188",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:36:16,211 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:36:16,213 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:36:16,216 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:36:16,216 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:36:16,216 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:36:16,216 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:36:16,216 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:36:16,217 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:36:16,217 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:36:16,218 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:36:24,767 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:36:24,767 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:36:24.766994
2025-10-22 16:36:24,767 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:36:24,767 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:36:24.766994",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:36:24,794 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:36:24,796 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:36:24,800 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:36:24,800 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:36:24,800 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:36:24,800 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:36:24,800 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:36:24,800 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:36:24,800 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:36:24,802 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:36:29,467 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:36:29,467 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:36:29.467559
2025-10-22 16:36:29,468 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:36:29,468 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:36:29.467559",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:36:29,495 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:36:29,497 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:36:29,501 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:36:29,501 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:36:29,501 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:36:29,501 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:36:29,501 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:36:29,502 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:36:29,502 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:36:29,503 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:36:46,219 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:36:46,219 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:36:46.218961
2025-10-22 16:36:46,219 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:36:46,219 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:36:46.218961",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:36:46,249 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:36:46,250 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:36:46,258 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:36:46,258 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:36:46,258 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:36:46,258 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:36:46,258 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:36:46,258 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:36:46,259 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:36:46,260 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:36:54,802 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:36:54,803 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:36:54.802692
2025-10-22 16:36:54,803 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:36:54,803 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:36:54.802692",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:36:54,832 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:36:54,833 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:36:54,837 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:36:54,837 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:36:54,837 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:36:54,837 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:36:54,837 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:36:54,837 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:36:54,837 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:36:54,838 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:36:59,466 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:36:59,466 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:36:59.466162
2025-10-22 16:36:59,466 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:36:59,466 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:36:59.466162",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:36:59,501 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:36:59,503 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:36:59,506 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:36:59,506 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:36:59,506 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:36:59,506 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:36:59,506 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:36:59,507 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:36:59,507 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:36:59,508 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:37:16,260 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:37:16,261 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:37:16.260797
2025-10-22 16:37:16,261 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:37:16,261 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:37:16.260797",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:37:16,287 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:37:16,288 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:37:16,291 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:37:16,291 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:37:16,291 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:37:16,291 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:37:16,292 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:37:16,292 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:37:16,292 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:37:16,293 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:37:24,839 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:37:24,839 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:37:24.839569
2025-10-22 16:37:24,840 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:37:24,840 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:37:24.839569",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:37:24,871 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:37:24,873 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:37:24,881 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:37:24,881 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:37:24,881 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:37:24,881 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:37:24,882 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:37:24,882 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:37:24,882 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:37:24,885 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:37:29,498 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:37:29,498 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:37:29.498001
2025-10-22 16:37:29,498 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:37:29,498 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:37:29.498001",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:37:29,523 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:37:29,524 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:37:29,528 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:37:29,529 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:37:29,529 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:37:29,529 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:37:29,529 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:37:29,529 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:37:29,529 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:37:29,530 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:37:46,293 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:37:46,294 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:37:46.293846
2025-10-22 16:37:46,294 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:37:46,294 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:37:46.293846",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:37:46,319 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:37:46,320 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:37:46,324 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:37:46,324 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:37:46,324 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:37:46,324 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:37:46,325 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:37:46,325 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:37:46,325 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:37:46,326 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:37:54,885 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:37:54,886 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:37:54.885605
2025-10-22 16:37:54,886 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:37:54,886 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:37:54.885605",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:37:54,915 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:37:54,917 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:37:54,922 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:37:54,922 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:37:54,923 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:37:54,923 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:37:54,923 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:37:54,923 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:37:54,923 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:37:54,924 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:37:59,468 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:37:59,468 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:37:59.468118
2025-10-22 16:37:59,468 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:37:59,469 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:37:59.468118",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:37:59,496 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:37:59,498 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:37:59,502 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:37:59,503 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:37:59,503 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:37:59,503 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:37:59,503 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:37:59,503 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:37:59,503 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:37:59,505 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:38:16,327 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:38:16,327 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:38:16.327113
2025-10-22 16:38:16,327 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:38:16,328 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:38:16.327113",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:38:16,355 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:38:16,356 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:38:16,360 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:38:16,361 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:38:16,361 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:38:16,361 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:38:16,361 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:38:16,361 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:38:16,361 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:38:16,363 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:38:24,925 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:38:24,925 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:38:24.925567
2025-10-22 16:38:24,926 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:38:24,926 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:38:24.925567",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:38:24,954 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:38:24,956 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:38:24,960 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:38:24,960 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:38:24,960 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:38:24,960 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:38:24,960 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:38:24,961 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:38:24,961 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:38:24,962 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:38:29,470 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:38:29,470 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:38:29.470046
2025-10-22 16:38:29,470 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:38:29,470 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:38:29.470046",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:38:29,497 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:38:29,499 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:38:29,503 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:38:29,503 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:38:29,503 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:38:29,503 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:38:29,503 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:38:29,504 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:38:29,504 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:38:29,505 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:38:46,363 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:38:46,363 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:38:46.363624
2025-10-22 16:38:46,364 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:38:46,364 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:38:46.363624",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:38:46,389 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:38:46,391 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:38:46,394 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:38:46,395 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:38:46,395 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:38:46,395 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:38:46,395 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:38:46,395 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:38:46,395 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:38:46,396 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:38:54,963 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:38:54,963 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:38:54.962965
2025-10-22 16:38:54,963 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:38:54,963 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:38:54.962965",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:38:54,990 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:38:54,992 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:38:54,996 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:38:54,996 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:38:54,996 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:38:54,996 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:38:54,996 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:38:54,996 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:38:54,996 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:38:54,997 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:38:59,469 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:38:59,469 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:38:59.469525
2025-10-22 16:38:59,470 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:38:59,470 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:38:59.469525",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:38:59,496 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:38:59,498 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:38:59,502 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:38:59,502 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:38:59,503 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:38:59,503 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:38:59,503 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:38:59,503 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:38:59,503 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:38:59,504 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:39:16,397 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:39:16,397 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:39:16.397577
2025-10-22 16:39:16,398 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:39:16,398 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:39:16.397577",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:39:16,435 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:39:16,437 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:39:16,441 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:39:16,441 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:39:16,441 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:39:16,441 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:39:16,441 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:39:16,441 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:39:16,442 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:39:16,443 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:39:24,998 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:39:24,998 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:39:24.998561
2025-10-22 16:39:24,999 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:39:24,999 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:39:24.998561",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:39:25,027 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:39:25,029 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:39:25,038 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:39:25,038 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:39:25,038 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:39:25,039 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:39:25,039 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:39:25,039 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:39:25,039 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:39:25,040 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:39:29,471 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:39:29,471 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:39:29.471593
2025-10-22 16:39:29,472 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:39:29,472 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:39:29.471593",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:39:29,500 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:39:29,502 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:39:29,506 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:39:29,506 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:39:29,506 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:39:29,506 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:39:29,506 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:39:29,506 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:39:29,507 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:39:29,508 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:39:46,444 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:39:46,444 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:39:46.443965
2025-10-22 16:39:46,444 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:39:46,445 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:39:46.443965",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:39:46,473 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:39:46,475 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:39:46,479 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:39:46,479 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:39:46,479 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:39:46,479 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:39:46,479 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:39:46,479 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:39:46,480 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:39:46,481 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:39:55,041 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:39:55,041 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:39:55.041181
2025-10-22 16:39:55,041 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:39:55,042 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:39:55.041181",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:39:55,069 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:39:55,071 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:39:55,075 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:39:55,075 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:39:55,075 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:39:55,076 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:39:55,076 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:39:55,076 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:39:55,076 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:39:55,077 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:39:59,471 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:39:59,471 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:39:59.470994
2025-10-22 16:39:59,471 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:39:59,471 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:39:59.470994",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:39:59,505 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:39:59,506 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:39:59,510 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:39:59,510 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:39:59,511 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:39:59,511 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:39:59,511 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:39:59,511 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:39:59,511 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:39:59,512 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:40:16,481 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:40:16,482 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:40:16.481881
2025-10-22 16:40:16,482 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:40:16,482 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:40:16.481881",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:40:16,505 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:40:16,506 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:40:16,510 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:40:16,511 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:40:16,511 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:40:16,511 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:40:16,511 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:40:16,511 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:40:16,511 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:40:16,512 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:40:25,078 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:40:25,078 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:40:25.078309
2025-10-22 16:40:25,078 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:40:25,079 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:40:25.078309",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:40:25,111 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:40:25,113 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:40:25,120 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:40:25,121 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:40:25,121 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:40:25,121 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:40:25,121 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:40:25,121 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:40:25,121 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:40:25,123 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:40:29,472 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:40:29,472 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:40:29.472165
2025-10-22 16:40:29,472 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:40:29,473 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:40:29.472165",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:40:29,500 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:40:29,502 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:40:29,506 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:40:29,506 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:40:29,506 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:40:29,506 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:40:29,507 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:40:29,507 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:40:29,507 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:40:29,508 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:40:46,513 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:40:46,513 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:40:46.513375
2025-10-22 16:40:46,514 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:40:46,514 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:40:46.513375",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:40:46,537 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:40:46,539 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:40:46,544 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:40:46,544 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:40:46,544 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:40:46,544 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:40:46,544 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:40:46,545 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:40:46,545 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:40:46,546 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:40:55,124 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:40:55,125 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:40:55.124683
2025-10-22 16:40:55,125 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:40:55,125 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:40:55.124683",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:40:55,153 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:40:55,155 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:40:55,160 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:40:55,160 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:40:55,160 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:40:55,160 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:40:55,160 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:40:55,160 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:40:55,160 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:40:55,162 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:40:59,489 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:40:59,490 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:40:59.489675
2025-10-22 16:40:59,490 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:40:59,490 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:40:59.489675",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:40:59,516 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:40:59,518 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:40:59,522 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:40:59,522 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:40:59,523 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:40:59,523 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:40:59,523 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:40:59,523 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:40:59,523 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:40:59,524 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:41:16,547 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:41:16,547 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:41:16.547080
2025-10-22 16:41:16,547 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:41:16,548 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:41:16.547080",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:41:16,574 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:41:16,576 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:41:16,580 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:41:16,580 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:41:16,580 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:41:16,581 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:41:16,581 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:41:16,581 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:41:16,581 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:41:16,582 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:41:25,162 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:41:25,163 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:41:25.162822
2025-10-22 16:41:25,163 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:41:25,163 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:41:25.162822",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:41:25,197 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:41:25,199 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:41:25,210 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:41:25,210 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:41:25,211 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:41:25,211 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:41:25,211 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:41:25,211 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:41:25,211 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:41:25,212 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:41:29,487 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:41:29,487 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:41:29.487241
2025-10-22 16:41:29,487 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:41:29,488 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:41:29.487241",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:41:29,515 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:41:29,517 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:41:29,521 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:41:29,521 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:41:29,521 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:41:29,522 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:41:29,522 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:41:29,522 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:41:29,522 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:41:29,523 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:41:46,583 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:41:46,583 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:41:46.583211
2025-10-22 16:41:46,583 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:41:46,584 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:41:46.583211",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:41:46,610 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:41:46,611 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:41:46,614 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:41:46,614 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:41:46,614 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:41:46,614 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:41:46,614 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:41:46,614 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:41:46,614 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:41:46,615 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:41:55,213 - server - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:41:55,213 - server - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:41:55.213371
2025-10-22 16:41:55,214 - server - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:41:55,214 - server - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:41:55.213371",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:41:55,240 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:41:55,242 - server - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:41:55,246 - server - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:41:55,246 - server - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:41:55,246 - server - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:41:55,246 - server - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:41:55,246 - server - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:41:55,246 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:41:55,247 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:41:55,248 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:41:59,476 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:41:59,477 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:41:59.476759
2025-10-22 16:41:59,477 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:41:59,477 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:41:59.476759",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:41:59,502 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:41:59,504 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:41:59,508 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:41:59,508 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:41:59,508 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:41:59,508 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:41:59,508 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:41:59,509 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:41:59,509 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:41:59,510 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
2025-10-22 16:42:16,616 - __main__ - INFO - get_todays_alerts:171 - 📊 Getting today's alerts
2025-10-22 16:42:16,616 - __main__ - INFO - get_alerts_by_time_range:160 - 📊 Getting alerts from 2025-10-22T00:00:00 to 2025-10-22T16:42:16.616209
2025-10-22 16:42:16,616 - __main__ - DEBUG - _make_request:106 - 🔍 Making request to: https://127.0.0.1:9200/wazuh-alerts-4.x-*/_search
2025-10-22 16:42:16,617 - __main__ - DEBUG - _make_request:107 - 🔍 Query: {
  "query": {
    "range": {
      "@timestamp": {
        "gte": "2025-10-22T00:00:00",
        "lte": "2025-10-22T16:42:16.616209",
        "format": "strict_date_optional_time"
      }
    }
  },
  "size": 1000,
  "sort": [
    {
      "@timestamp": {
        "order": "desc"
      }
    }
  ],
  "aggs": {
    "severity_stats": {
      "stats": {
        "field": "rule.level"
      }
    },
    "top_agents": {
      "terms": {
        "field": "agent.name.keyword",
        "size": 10
      }
    },
    "alerts_over_time": {
      "date_histogram": {
        "field": "@timestamp",
        "calendar_interval": "hour"
      }
    }
  }
}
2025-10-22 16:42:16,651 - urllib3.connectionpool - DEBUG - _make_request:544 - https://127.0.0.1:9200 "GET /wazuh-alerts-4.x-*/_search HTTP/1.1" 200 124314
2025-10-22 16:42:16,653 - __main__ - DEBUG - _make_request:110 - 🔍 Response status: 200
2025-10-22 16:42:16,657 - __main__ - DEBUG - _make_request:115 - 🔍 Response keys: ['took', 'timed_out', '_shards', 'hits', 'aggregations']
2025-10-22 16:42:16,657 - __main__ - DEBUG - _make_request:119 - 🔍 Total hits: 78, Actual hits: 78
2025-10-22 16:42:16,658 - __main__ - DEBUG - _make_request:124 - 🔍 First hit ID: O3puC5oBnysS8cfeLnuA
2025-10-22 16:42:16,658 - __main__ - DEBUG - _make_request:125 - 🔍 First hit timestamp: 2025-10-22T10:19:19.383Z
2025-10-22 16:42:16,658 - __main__ - DEBUG - _make_request:126 - 🔍 First hit rule groups: ['syslog', 'sshd', 'authentication_success']
2025-10-22 16:42:16,658 - root - DEBUG - process_alerts_for_dashboard:264 - 🔄 Processing alerts for dashboard
2025-10-22 16:42:16,658 - root - INFO - process_alerts_for_dashboard:278 - 🔄 Processing 78 total alerts, 78 returned
2025-10-22 16:42:16,659 - root - INFO - process_alerts_for_dashboard:334 - ✅ Processed 78 alerts for dashboard
